function BKB=calcBKBPrism_quad(B,K,ii)
% BKB = calcBKBPrism_quad(B, K, ii)
%
% Computes the product B'*K*B in vectorized manner for quadratic Prism
% elements
%
% Input
% B : [Nel x 54] (18x3=54) contains the contributions of each element to the final
%      conductance matrix
% K : [Nel x Nanis] Hydraulic conductiviy element values. The number of columns 
%     is defined by the anisotropy. Maximum number is 3.
% ii : In case of nested assembly this indicates the iteration. In
%       vectorized assembly this is empty 
%
% Output
% BKB the product B'*K*B
%
% Version : 1.0
% Author : George Kourakos
% email: giorgk@gmail.com
% web : http://groundwater.ucdavis.edu/msim
% Date 18-Dec_2012
% Department of Land Air and Water
% University of California Davis
%
% how to compute the product using matlab symbolic toolbox
%
% syms b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18
% syms b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29 b30 b31 b32 b33 b34 b35 b36
% syms b37 b38 b39 b40 b41 b42 b43 b44 b45 b46 b47 b48 b49 b50 b51 b52 b53 b54
% syms kx ky kz
% B=[b1 b2 b3 b4 b5 b6 b7 b8 b9 b10 b11 b12 b13 b14 b15 b16 b17 b18;...
%    b19 b20 b21 b22 b23 b24 b25 b26 b27 b28 b29 b30 b31 b32 b33 b34 b35 b36;...
%    b37 b38 b39 b40 b41 b42 b43 b44 b45 b46 b47 b48 b49 b50 b51 b52 b53 b54];
% 
% B1=[ b1 b19 b37;...
%      b2 b20 b38;...
%      b3 b21 b39;...
%      b4 b22 b40;...
%      b5 b23 b41;...
%      b6 b24 b42;...
%      b7 b25 b43;...
%      b8 b26 b44;...
%      b9 b27 b45;...
%      b10 b28 b46;...
%      b11 b29 b47;...
%      b12 b30 b48;...
%      b13 b31 b49;...
%      b14 b32 b50;...
%      b15 b33 b51;...
%      b16 b34 b52;...
%      b17 b35 b53;...
%      b18 b36 b54];
%  
% K=[kx 0 0;...
%     0 ky 0;...
%     0  0  kz];
%  
% BKB=B1*K*B
%  
% cnt=0;
% for i=1:18
%     for j=1:18
%         cnt=cnt+1;
%         fprintf(['BKB(:,%d) = ' char(BKB(i,j)) ';\n'],cnt);
%     end
% end
%
% see also calcBKB, Assemble_LHS

kx=K(:,1);ky=K(:,2);kz=K(:,3);
if isempty(ii)
    BKB(:,1) = kx.*B(:,1).^2 + ky.*B(:,19).^2 + kz.*B(:,37).^2;
    BKB(:,2) = B(:,1).*B(:,2).*kx + B(:,19).*B(:,20).*ky + B(:,37).*B(:,38).*kz;
    BKB(:,3) = B(:,1).*B(:,3).*kx + B(:,19).*B(:,21).*ky + B(:,37).*B(:,39).*kz;
    BKB(:,4) = B(:,1).*B(:,4).*kx + B(:,19).*B(:,22).*ky + B(:,37).*B(:,40).*kz;
    BKB(:,5) = B(:,1).*B(:,5).*kx + B(:,19).*B(:,23).*ky + B(:,37).*B(:,41).*kz;
    BKB(:,6) = B(:,1).*B(:,6).*kx + B(:,19).*B(:,24).*ky + B(:,37).*B(:,42).*kz;
    BKB(:,7) = B(:,1).*B(:,7).*kx + B(:,19).*B(:,25).*ky + B(:,37).*B(:,43).*kz;
    BKB(:,8) = B(:,1).*B(:,8).*kx + B(:,19).*B(:,26).*ky + B(:,37).*B(:,44).*kz;
    BKB(:,9) = B(:,1).*B(:,9).*kx + B(:,19).*B(:,27).*ky + B(:,37).*B(:,45).*kz;
    BKB(:,10) = B(:,1).*B(:,10).*kx + B(:,19).*B(:,28).*ky + B(:,37).*B(:,46).*kz;
    BKB(:,11) = B(:,1).*B(:,11).*kx + B(:,19).*B(:,29).*ky + B(:,37).*B(:,47).*kz;
    BKB(:,12) = B(:,1).*B(:,12).*kx + B(:,19).*B(:,30).*ky + B(:,37).*B(:,48).*kz;
    BKB(:,13) = B(:,1).*B(:,13).*kx + B(:,19).*B(:,31).*ky + B(:,37).*B(:,49).*kz;
    BKB(:,14) = B(:,1).*B(:,14).*kx + B(:,19).*B(:,32).*ky + B(:,37).*B(:,50).*kz;
    BKB(:,15) = B(:,1).*B(:,15).*kx + B(:,19).*B(:,33).*ky + B(:,37).*B(:,51).*kz;
    BKB(:,16) = B(:,1).*B(:,16).*kx + B(:,19).*B(:,34).*ky + B(:,37).*B(:,52).*kz;
    BKB(:,17) = B(:,1).*B(:,17).*kx + B(:,19).*B(:,35).*ky + B(:,37).*B(:,53).*kz;
    BKB(:,18) = B(:,1).*B(:,18).*kx + B(:,19).*B(:,36).*ky + B(:,37).*B(:,54).*kz;
    BKB(:,19) = B(:,1).*B(:,2).*kx + B(:,19).*B(:,20).*ky + B(:,37).*B(:,38).*kz;
    BKB(:,20) = kx.*B(:,2).^2 + ky.*B(:,20).^2 + kz.*B(:,38).^2;
    BKB(:,21) = B(:,2).*B(:,3).*kx + B(:,20).*B(:,21).*ky + B(:,38).*B(:,39).*kz;
    BKB(:,22) = B(:,2).*B(:,4).*kx + B(:,20).*B(:,22).*ky + B(:,38).*B(:,40).*kz;
    BKB(:,23) = B(:,2).*B(:,5).*kx + B(:,20).*B(:,23).*ky + B(:,38).*B(:,41).*kz;
    BKB(:,24) = B(:,2).*B(:,6).*kx + B(:,20).*B(:,24).*ky + B(:,38).*B(:,42).*kz;
    BKB(:,25) = B(:,2).*B(:,7).*kx + B(:,20).*B(:,25).*ky + B(:,38).*B(:,43).*kz;
    BKB(:,26) = B(:,2).*B(:,8).*kx + B(:,20).*B(:,26).*ky + B(:,38).*B(:,44).*kz;
    BKB(:,27) = B(:,2).*B(:,9).*kx + B(:,20).*B(:,27).*ky + B(:,38).*B(:,45).*kz;
    BKB(:,28) = B(:,2).*B(:,10).*kx + B(:,20).*B(:,28).*ky + B(:,38).*B(:,46).*kz;
    BKB(:,29) = B(:,2).*B(:,11).*kx + B(:,20).*B(:,29).*ky + B(:,38).*B(:,47).*kz;
    BKB(:,30) = B(:,2).*B(:,12).*kx + B(:,20).*B(:,30).*ky + B(:,38).*B(:,48).*kz;
    BKB(:,31) = B(:,2).*B(:,13).*kx + B(:,20).*B(:,31).*ky + B(:,38).*B(:,49).*kz;
    BKB(:,32) = B(:,2).*B(:,14).*kx + B(:,20).*B(:,32).*ky + B(:,38).*B(:,50).*kz;
    BKB(:,33) = B(:,2).*B(:,15).*kx + B(:,20).*B(:,33).*ky + B(:,38).*B(:,51).*kz;
    BKB(:,34) = B(:,2).*B(:,16).*kx + B(:,20).*B(:,34).*ky + B(:,38).*B(:,52).*kz;
    BKB(:,35) = B(:,2).*B(:,17).*kx + B(:,20).*B(:,35).*ky + B(:,38).*B(:,53).*kz;
    BKB(:,36) = B(:,2).*B(:,18).*kx + B(:,20).*B(:,36).*ky + B(:,38).*B(:,54).*kz;
    BKB(:,37) = B(:,1).*B(:,3).*kx + B(:,19).*B(:,21).*ky + B(:,37).*B(:,39).*kz;
    BKB(:,38) = B(:,2).*B(:,3).*kx + B(:,20).*B(:,21).*ky + B(:,38).*B(:,39).*kz;
    BKB(:,39) = kx.*B(:,3).^2 + ky.*B(:,21).^2 + kz.*B(:,39).^2;
    BKB(:,40) = B(:,3).*B(:,4).*kx + B(:,21).*B(:,22).*ky + B(:,39).*B(:,40).*kz;
    BKB(:,41) = B(:,3).*B(:,5).*kx + B(:,21).*B(:,23).*ky + B(:,39).*B(:,41).*kz;
    BKB(:,42) = B(:,3).*B(:,6).*kx + B(:,21).*B(:,24).*ky + B(:,39).*B(:,42).*kz;
    BKB(:,43) = B(:,3).*B(:,7).*kx + B(:,21).*B(:,25).*ky + B(:,39).*B(:,43).*kz;
    BKB(:,44) = B(:,3).*B(:,8).*kx + B(:,21).*B(:,26).*ky + B(:,39).*B(:,44).*kz;
    BKB(:,45) = B(:,3).*B(:,9).*kx + B(:,21).*B(:,27).*ky + B(:,39).*B(:,45).*kz;
    BKB(:,46) = B(:,3).*B(:,10).*kx + B(:,21).*B(:,28).*ky + B(:,39).*B(:,46).*kz;
    BKB(:,47) = B(:,3).*B(:,11).*kx + B(:,21).*B(:,29).*ky + B(:,39).*B(:,47).*kz;
    BKB(:,48) = B(:,3).*B(:,12).*kx + B(:,21).*B(:,30).*ky + B(:,39).*B(:,48).*kz;
    BKB(:,49) = B(:,3).*B(:,13).*kx + B(:,21).*B(:,31).*ky + B(:,39).*B(:,49).*kz;
    BKB(:,50) = B(:,3).*B(:,14).*kx + B(:,21).*B(:,32).*ky + B(:,39).*B(:,50).*kz;
    BKB(:,51) = B(:,3).*B(:,15).*kx + B(:,21).*B(:,33).*ky + B(:,39).*B(:,51).*kz;
    BKB(:,52) = B(:,3).*B(:,16).*kx + B(:,21).*B(:,34).*ky + B(:,39).*B(:,52).*kz;
    BKB(:,53) = B(:,3).*B(:,17).*kx + B(:,21).*B(:,35).*ky + B(:,39).*B(:,53).*kz;
    BKB(:,54) = B(:,3).*B(:,18).*kx + B(:,21).*B(:,36).*ky + B(:,39).*B(:,54).*kz;
    BKB(:,55) = B(:,1).*B(:,4).*kx + B(:,19).*B(:,22).*ky + B(:,37).*B(:,40).*kz;
    BKB(:,56) = B(:,2).*B(:,4).*kx + B(:,20).*B(:,22).*ky + B(:,38).*B(:,40).*kz;
    BKB(:,57) = B(:,3).*B(:,4).*kx + B(:,21).*B(:,22).*ky + B(:,39).*B(:,40).*kz;
    BKB(:,58) = kx.*B(:,4).^2 + ky.*B(:,22).^2 + kz.*B(:,40).^2;
    BKB(:,59) = B(:,4).*B(:,5).*kx + B(:,22).*B(:,23).*ky + B(:,40).*B(:,41).*kz;
    BKB(:,60) = B(:,4).*B(:,6).*kx + B(:,22).*B(:,24).*ky + B(:,40).*B(:,42).*kz;
    BKB(:,61) = B(:,4).*B(:,7).*kx + B(:,22).*B(:,25).*ky + B(:,40).*B(:,43).*kz;
    BKB(:,62) = B(:,4).*B(:,8).*kx + B(:,22).*B(:,26).*ky + B(:,40).*B(:,44).*kz;
    BKB(:,63) = B(:,4).*B(:,9).*kx + B(:,22).*B(:,27).*ky + B(:,40).*B(:,45).*kz;
    BKB(:,64) = B(:,4).*B(:,10).*kx + B(:,22).*B(:,28).*ky + B(:,40).*B(:,46).*kz;
    BKB(:,65) = B(:,4).*B(:,11).*kx + B(:,22).*B(:,29).*ky + B(:,40).*B(:,47).*kz;
    BKB(:,66) = B(:,4).*B(:,12).*kx + B(:,22).*B(:,30).*ky + B(:,40).*B(:,48).*kz;
    BKB(:,67) = B(:,4).*B(:,13).*kx + B(:,22).*B(:,31).*ky + B(:,40).*B(:,49).*kz;
    BKB(:,68) = B(:,4).*B(:,14).*kx + B(:,22).*B(:,32).*ky + B(:,40).*B(:,50).*kz;
    BKB(:,69) = B(:,4).*B(:,15).*kx + B(:,22).*B(:,33).*ky + B(:,40).*B(:,51).*kz;
    BKB(:,70) = B(:,4).*B(:,16).*kx + B(:,22).*B(:,34).*ky + B(:,40).*B(:,52).*kz;
    BKB(:,71) = B(:,4).*B(:,17).*kx + B(:,22).*B(:,35).*ky + B(:,40).*B(:,53).*kz;
    BKB(:,72) = B(:,4).*B(:,18).*kx + B(:,22).*B(:,36).*ky + B(:,40).*B(:,54).*kz;
    BKB(:,73) = B(:,1).*B(:,5).*kx + B(:,19).*B(:,23).*ky + B(:,37).*B(:,41).*kz;
    BKB(:,74) = B(:,2).*B(:,5).*kx + B(:,20).*B(:,23).*ky + B(:,38).*B(:,41).*kz;
    BKB(:,75) = B(:,3).*B(:,5).*kx + B(:,21).*B(:,23).*ky + B(:,39).*B(:,41).*kz;
    BKB(:,76) = B(:,4).*B(:,5).*kx + B(:,22).*B(:,23).*ky + B(:,40).*B(:,41).*kz;
    BKB(:,77) = kx.*B(:,5).^2 + ky.*B(:,23).^2 + kz.*B(:,41).^2;
    BKB(:,78) = B(:,5).*B(:,6).*kx + B(:,23).*B(:,24).*ky + B(:,41).*B(:,42).*kz;
    BKB(:,79) = B(:,5).*B(:,7).*kx + B(:,23).*B(:,25).*ky + B(:,41).*B(:,43).*kz;
    BKB(:,80) = B(:,5).*B(:,8).*kx + B(:,23).*B(:,26).*ky + B(:,41).*B(:,44).*kz;
    BKB(:,81) = B(:,5).*B(:,9).*kx + B(:,23).*B(:,27).*ky + B(:,41).*B(:,45).*kz;
    BKB(:,82) = B(:,5).*B(:,10).*kx + B(:,23).*B(:,28).*ky + B(:,41).*B(:,46).*kz;
    BKB(:,83) = B(:,5).*B(:,11).*kx + B(:,23).*B(:,29).*ky + B(:,41).*B(:,47).*kz;
    BKB(:,84) = B(:,5).*B(:,12).*kx + B(:,23).*B(:,30).*ky + B(:,41).*B(:,48).*kz;
    BKB(:,85) = B(:,5).*B(:,13).*kx + B(:,23).*B(:,31).*ky + B(:,41).*B(:,49).*kz;
    BKB(:,86) = B(:,5).*B(:,14).*kx + B(:,23).*B(:,32).*ky + B(:,41).*B(:,50).*kz;
    BKB(:,87) = B(:,5).*B(:,15).*kx + B(:,23).*B(:,33).*ky + B(:,41).*B(:,51).*kz;
    BKB(:,88) = B(:,5).*B(:,16).*kx + B(:,23).*B(:,34).*ky + B(:,41).*B(:,52).*kz;
    BKB(:,89) = B(:,5).*B(:,17).*kx + B(:,23).*B(:,35).*ky + B(:,41).*B(:,53).*kz;
    BKB(:,90) = B(:,5).*B(:,18).*kx + B(:,23).*B(:,36).*ky + B(:,41).*B(:,54).*kz;
    BKB(:,91) = B(:,1).*B(:,6).*kx + B(:,19).*B(:,24).*ky + B(:,37).*B(:,42).*kz;
    BKB(:,92) = B(:,2).*B(:,6).*kx + B(:,20).*B(:,24).*ky + B(:,38).*B(:,42).*kz;
    BKB(:,93) = B(:,3).*B(:,6).*kx + B(:,21).*B(:,24).*ky + B(:,39).*B(:,42).*kz;
    BKB(:,94) = B(:,4).*B(:,6).*kx + B(:,22).*B(:,24).*ky + B(:,40).*B(:,42).*kz;
    BKB(:,95) = B(:,5).*B(:,6).*kx + B(:,23).*B(:,24).*ky + B(:,41).*B(:,42).*kz;
    BKB(:,96) = kx.*B(:,6).^2 + ky.*B(:,24).^2 + kz.*B(:,42).^2;
    BKB(:,97) = B(:,6).*B(:,7).*kx + B(:,24).*B(:,25).*ky + B(:,42).*B(:,43).*kz;
    BKB(:,98) = B(:,6).*B(:,8).*kx + B(:,24).*B(:,26).*ky + B(:,42).*B(:,44).*kz;
    BKB(:,99) = B(:,6).*B(:,9).*kx + B(:,24).*B(:,27).*ky + B(:,42).*B(:,45).*kz;
    BKB(:,100) = B(:,6).*B(:,10).*kx + B(:,24).*B(:,28).*ky + B(:,42).*B(:,46).*kz;
    BKB(:,101) = B(:,6).*B(:,11).*kx + B(:,24).*B(:,29).*ky + B(:,42).*B(:,47).*kz;
    BKB(:,102) = B(:,6).*B(:,12).*kx + B(:,24).*B(:,30).*ky + B(:,42).*B(:,48).*kz;
    BKB(:,103) = B(:,6).*B(:,13).*kx + B(:,24).*B(:,31).*ky + B(:,42).*B(:,49).*kz;
    BKB(:,104) = B(:,6).*B(:,14).*kx + B(:,24).*B(:,32).*ky + B(:,42).*B(:,50).*kz;
    BKB(:,105) = B(:,6).*B(:,15).*kx + B(:,24).*B(:,33).*ky + B(:,42).*B(:,51).*kz;
    BKB(:,106) = B(:,6).*B(:,16).*kx + B(:,24).*B(:,34).*ky + B(:,42).*B(:,52).*kz;
    BKB(:,107) = B(:,6).*B(:,17).*kx + B(:,24).*B(:,35).*ky + B(:,42).*B(:,53).*kz;
    BKB(:,108) = B(:,6).*B(:,18).*kx + B(:,24).*B(:,36).*ky + B(:,42).*B(:,54).*kz;
    BKB(:,109) = B(:,1).*B(:,7).*kx + B(:,19).*B(:,25).*ky + B(:,37).*B(:,43).*kz;
    BKB(:,110) = B(:,2).*B(:,7).*kx + B(:,20).*B(:,25).*ky + B(:,38).*B(:,43).*kz;
    BKB(:,111) = B(:,3).*B(:,7).*kx + B(:,21).*B(:,25).*ky + B(:,39).*B(:,43).*kz;
    BKB(:,112) = B(:,4).*B(:,7).*kx + B(:,22).*B(:,25).*ky + B(:,40).*B(:,43).*kz;
    BKB(:,113) = B(:,5).*B(:,7).*kx + B(:,23).*B(:,25).*ky + B(:,41).*B(:,43).*kz;
    BKB(:,114) = B(:,6).*B(:,7).*kx + B(:,24).*B(:,25).*ky + B(:,42).*B(:,43).*kz;
    BKB(:,115) = kx.*B(:,7).^2 + ky.*B(:,25).^2 + kz.*B(:,43).^2;
    BKB(:,116) = B(:,7).*B(:,8).*kx + B(:,25).*B(:,26).*ky + B(:,43).*B(:,44).*kz;
    BKB(:,117) = B(:,7).*B(:,9).*kx + B(:,25).*B(:,27).*ky + B(:,43).*B(:,45).*kz;
    BKB(:,118) = B(:,7).*B(:,10).*kx + B(:,25).*B(:,28).*ky + B(:,43).*B(:,46).*kz;
    BKB(:,119) = B(:,7).*B(:,11).*kx + B(:,25).*B(:,29).*ky + B(:,43).*B(:,47).*kz;
    BKB(:,120) = B(:,7).*B(:,12).*kx + B(:,25).*B(:,30).*ky + B(:,43).*B(:,48).*kz;
    BKB(:,121) = B(:,7).*B(:,13).*kx + B(:,25).*B(:,31).*ky + B(:,43).*B(:,49).*kz;
    BKB(:,122) = B(:,7).*B(:,14).*kx + B(:,25).*B(:,32).*ky + B(:,43).*B(:,50).*kz;
    BKB(:,123) = B(:,7).*B(:,15).*kx + B(:,25).*B(:,33).*ky + B(:,43).*B(:,51).*kz;
    BKB(:,124) = B(:,7).*B(:,16).*kx + B(:,25).*B(:,34).*ky + B(:,43).*B(:,52).*kz;
    BKB(:,125) = B(:,7).*B(:,17).*kx + B(:,25).*B(:,35).*ky + B(:,43).*B(:,53).*kz;
    BKB(:,126) = B(:,7).*B(:,18).*kx + B(:,25).*B(:,36).*ky + B(:,43).*B(:,54).*kz;
    BKB(:,127) = B(:,1).*B(:,8).*kx + B(:,19).*B(:,26).*ky + B(:,37).*B(:,44).*kz;
    BKB(:,128) = B(:,2).*B(:,8).*kx + B(:,20).*B(:,26).*ky + B(:,38).*B(:,44).*kz;
    BKB(:,129) = B(:,3).*B(:,8).*kx + B(:,21).*B(:,26).*ky + B(:,39).*B(:,44).*kz;
    BKB(:,130) = B(:,4).*B(:,8).*kx + B(:,22).*B(:,26).*ky + B(:,40).*B(:,44).*kz;
    BKB(:,131) = B(:,5).*B(:,8).*kx + B(:,23).*B(:,26).*ky + B(:,41).*B(:,44).*kz;
    BKB(:,132) = B(:,6).*B(:,8).*kx + B(:,24).*B(:,26).*ky + B(:,42).*B(:,44).*kz;
    BKB(:,133) = B(:,7).*B(:,8).*kx + B(:,25).*B(:,26).*ky + B(:,43).*B(:,44).*kz;
    BKB(:,134) = kx.*B(:,8).^2 + ky.*B(:,26).^2 + kz.*B(:,44).^2;
    BKB(:,135) = B(:,8).*B(:,9).*kx + B(:,26).*B(:,27).*ky + B(:,44).*B(:,45).*kz;
    BKB(:,136) = B(:,8).*B(:,10).*kx + B(:,26).*B(:,28).*ky + B(:,44).*B(:,46).*kz;
    BKB(:,137) = B(:,8).*B(:,11).*kx + B(:,26).*B(:,29).*ky + B(:,44).*B(:,47).*kz;
    BKB(:,138) = B(:,8).*B(:,12).*kx + B(:,26).*B(:,30).*ky + B(:,44).*B(:,48).*kz;
    BKB(:,139) = B(:,8).*B(:,13).*kx + B(:,26).*B(:,31).*ky + B(:,44).*B(:,49).*kz;
    BKB(:,140) = B(:,8).*B(:,14).*kx + B(:,26).*B(:,32).*ky + B(:,44).*B(:,50).*kz;
    BKB(:,141) = B(:,8).*B(:,15).*kx + B(:,26).*B(:,33).*ky + B(:,44).*B(:,51).*kz;
    BKB(:,142) = B(:,8).*B(:,16).*kx + B(:,26).*B(:,34).*ky + B(:,44).*B(:,52).*kz;
    BKB(:,143) = B(:,8).*B(:,17).*kx + B(:,26).*B(:,35).*ky + B(:,44).*B(:,53).*kz;
    BKB(:,144) = B(:,8).*B(:,18).*kx + B(:,26).*B(:,36).*ky + B(:,44).*B(:,54).*kz;
    BKB(:,145) = B(:,1).*B(:,9).*kx + B(:,19).*B(:,27).*ky + B(:,37).*B(:,45).*kz;
    BKB(:,146) = B(:,2).*B(:,9).*kx + B(:,20).*B(:,27).*ky + B(:,38).*B(:,45).*kz;
    BKB(:,147) = B(:,3).*B(:,9).*kx + B(:,21).*B(:,27).*ky + B(:,39).*B(:,45).*kz;
    BKB(:,148) = B(:,4).*B(:,9).*kx + B(:,22).*B(:,27).*ky + B(:,40).*B(:,45).*kz;
    BKB(:,149) = B(:,5).*B(:,9).*kx + B(:,23).*B(:,27).*ky + B(:,41).*B(:,45).*kz;
    BKB(:,150) = B(:,6).*B(:,9).*kx + B(:,24).*B(:,27).*ky + B(:,42).*B(:,45).*kz;
    BKB(:,151) = B(:,7).*B(:,9).*kx + B(:,25).*B(:,27).*ky + B(:,43).*B(:,45).*kz;
    BKB(:,152) = B(:,8).*B(:,9).*kx + B(:,26).*B(:,27).*ky + B(:,44).*B(:,45).*kz;
    BKB(:,153) = kx.*B(:,9).^2 + ky.*B(:,27).^2 + kz.*B(:,45).^2;
    BKB(:,154) = B(:,9).*B(:,10).*kx + B(:,27).*B(:,28).*ky + B(:,45).*B(:,46).*kz;
    BKB(:,155) = B(:,9).*B(:,11).*kx + B(:,27).*B(:,29).*ky + B(:,45).*B(:,47).*kz;
    BKB(:,156) = B(:,9).*B(:,12).*kx + B(:,27).*B(:,30).*ky + B(:,45).*B(:,48).*kz;
    BKB(:,157) = B(:,9).*B(:,13).*kx + B(:,27).*B(:,31).*ky + B(:,45).*B(:,49).*kz;
    BKB(:,158) = B(:,9).*B(:,14).*kx + B(:,27).*B(:,32).*ky + B(:,45).*B(:,50).*kz;
    BKB(:,159) = B(:,9).*B(:,15).*kx + B(:,27).*B(:,33).*ky + B(:,45).*B(:,51).*kz;
    BKB(:,160) = B(:,9).*B(:,16).*kx + B(:,27).*B(:,34).*ky + B(:,45).*B(:,52).*kz;
    BKB(:,161) = B(:,9).*B(:,17).*kx + B(:,27).*B(:,35).*ky + B(:,45).*B(:,53).*kz;
    BKB(:,162) = B(:,9).*B(:,18).*kx + B(:,27).*B(:,36).*ky + B(:,45).*B(:,54).*kz;
    BKB(:,163) = B(:,1).*B(:,10).*kx + B(:,19).*B(:,28).*ky + B(:,37).*B(:,46).*kz;
    BKB(:,164) = B(:,2).*B(:,10).*kx + B(:,20).*B(:,28).*ky + B(:,38).*B(:,46).*kz;
    BKB(:,165) = B(:,3).*B(:,10).*kx + B(:,21).*B(:,28).*ky + B(:,39).*B(:,46).*kz;
    BKB(:,166) = B(:,4).*B(:,10).*kx + B(:,22).*B(:,28).*ky + B(:,40).*B(:,46).*kz;
    BKB(:,167) = B(:,5).*B(:,10).*kx + B(:,23).*B(:,28).*ky + B(:,41).*B(:,46).*kz;
    BKB(:,168) = B(:,6).*B(:,10).*kx + B(:,24).*B(:,28).*ky + B(:,42).*B(:,46).*kz;
    BKB(:,169) = B(:,7).*B(:,10).*kx + B(:,25).*B(:,28).*ky + B(:,43).*B(:,46).*kz;
    BKB(:,170) = B(:,8).*B(:,10).*kx + B(:,26).*B(:,28).*ky + B(:,44).*B(:,46).*kz;
    BKB(:,171) = B(:,9).*B(:,10).*kx + B(:,27).*B(:,28).*ky + B(:,45).*B(:,46).*kz;
    BKB(:,172) = kx.*B(:,10).^2 + ky.*B(:,28).^2 + kz.*B(:,46).^2;
    BKB(:,173) = B(:,10).*B(:,11).*kx + B(:,28).*B(:,29).*ky + B(:,46).*B(:,47).*kz;
    BKB(:,174) = B(:,10).*B(:,12).*kx + B(:,28).*B(:,30).*ky + B(:,46).*B(:,48).*kz;
    BKB(:,175) = B(:,10).*B(:,13).*kx + B(:,28).*B(:,31).*ky + B(:,46).*B(:,49).*kz;
    BKB(:,176) = B(:,10).*B(:,14).*kx + B(:,28).*B(:,32).*ky + B(:,46).*B(:,50).*kz;
    BKB(:,177) = B(:,10).*B(:,15).*kx + B(:,28).*B(:,33).*ky + B(:,46).*B(:,51).*kz;
    BKB(:,178) = B(:,10).*B(:,16).*kx + B(:,28).*B(:,34).*ky + B(:,46).*B(:,52).*kz;
    BKB(:,179) = B(:,10).*B(:,17).*kx + B(:,28).*B(:,35).*ky + B(:,46).*B(:,53).*kz;
    BKB(:,180) = B(:,10).*B(:,18).*kx + B(:,28).*B(:,36).*ky + B(:,46).*B(:,54).*kz;
    BKB(:,181) = B(:,1).*B(:,11).*kx + B(:,19).*B(:,29).*ky + B(:,37).*B(:,47).*kz;
    BKB(:,182) = B(:,2).*B(:,11).*kx + B(:,20).*B(:,29).*ky + B(:,38).*B(:,47).*kz;
    BKB(:,183) = B(:,3).*B(:,11).*kx + B(:,21).*B(:,29).*ky + B(:,39).*B(:,47).*kz;
    BKB(:,184) = B(:,4).*B(:,11).*kx + B(:,22).*B(:,29).*ky + B(:,40).*B(:,47).*kz;
    BKB(:,185) = B(:,5).*B(:,11).*kx + B(:,23).*B(:,29).*ky + B(:,41).*B(:,47).*kz;
    BKB(:,186) = B(:,6).*B(:,11).*kx + B(:,24).*B(:,29).*ky + B(:,42).*B(:,47).*kz;
    BKB(:,187) = B(:,7).*B(:,11).*kx + B(:,25).*B(:,29).*ky + B(:,43).*B(:,47).*kz;
    BKB(:,188) = B(:,8).*B(:,11).*kx + B(:,26).*B(:,29).*ky + B(:,44).*B(:,47).*kz;
    BKB(:,189) = B(:,9).*B(:,11).*kx + B(:,27).*B(:,29).*ky + B(:,45).*B(:,47).*kz;
    BKB(:,190) = B(:,10).*B(:,11).*kx + B(:,28).*B(:,29).*ky + B(:,46).*B(:,47).*kz;
    BKB(:,191) = kx.*B(:,11).^2 + ky.*B(:,29).^2 + kz.*B(:,47).^2;
    BKB(:,192) = B(:,11).*B(:,12).*kx + B(:,29).*B(:,30).*ky + B(:,47).*B(:,48).*kz;
    BKB(:,193) = B(:,11).*B(:,13).*kx + B(:,29).*B(:,31).*ky + B(:,47).*B(:,49).*kz;
    BKB(:,194) = B(:,11).*B(:,14).*kx + B(:,29).*B(:,32).*ky + B(:,47).*B(:,50).*kz;
    BKB(:,195) = B(:,11).*B(:,15).*kx + B(:,29).*B(:,33).*ky + B(:,47).*B(:,51).*kz;
    BKB(:,196) = B(:,11).*B(:,16).*kx + B(:,29).*B(:,34).*ky + B(:,47).*B(:,52).*kz;
    BKB(:,197) = B(:,11).*B(:,17).*kx + B(:,29).*B(:,35).*ky + B(:,47).*B(:,53).*kz;
    BKB(:,198) = B(:,11).*B(:,18).*kx + B(:,29).*B(:,36).*ky + B(:,47).*B(:,54).*kz;
    BKB(:,199) = B(:,1).*B(:,12).*kx + B(:,19).*B(:,30).*ky + B(:,37).*B(:,48).*kz;
    BKB(:,200) = B(:,2).*B(:,12).*kx + B(:,20).*B(:,30).*ky + B(:,38).*B(:,48).*kz;
    BKB(:,201) = B(:,3).*B(:,12).*kx + B(:,21).*B(:,30).*ky + B(:,39).*B(:,48).*kz;
    BKB(:,202) = B(:,4).*B(:,12).*kx + B(:,22).*B(:,30).*ky + B(:,40).*B(:,48).*kz;
    BKB(:,203) = B(:,5).*B(:,12).*kx + B(:,23).*B(:,30).*ky + B(:,41).*B(:,48).*kz;
    BKB(:,204) = B(:,6).*B(:,12).*kx + B(:,24).*B(:,30).*ky + B(:,42).*B(:,48).*kz;
    BKB(:,205) = B(:,7).*B(:,12).*kx + B(:,25).*B(:,30).*ky + B(:,43).*B(:,48).*kz;
    BKB(:,206) = B(:,8).*B(:,12).*kx + B(:,26).*B(:,30).*ky + B(:,44).*B(:,48).*kz;
    BKB(:,207) = B(:,9).*B(:,12).*kx + B(:,27).*B(:,30).*ky + B(:,45).*B(:,48).*kz;
    BKB(:,208) = B(:,10).*B(:,12).*kx + B(:,28).*B(:,30).*ky + B(:,46).*B(:,48).*kz;
    BKB(:,209) = B(:,11).*B(:,12).*kx + B(:,29).*B(:,30).*ky + B(:,47).*B(:,48).*kz;
    BKB(:,210) = kx.*B(:,12).^2 + ky.*B(:,30).^2 + kz.*B(:,48).^2;
    BKB(:,211) = B(:,12).*B(:,13).*kx + B(:,30).*B(:,31).*ky + B(:,48).*B(:,49).*kz;
    BKB(:,212) = B(:,12).*B(:,14).*kx + B(:,30).*B(:,32).*ky + B(:,48).*B(:,50).*kz;
    BKB(:,213) = B(:,12).*B(:,15).*kx + B(:,30).*B(:,33).*ky + B(:,48).*B(:,51).*kz;
    BKB(:,214) = B(:,12).*B(:,16).*kx + B(:,30).*B(:,34).*ky + B(:,48).*B(:,52).*kz;
    BKB(:,215) = B(:,12).*B(:,17).*kx + B(:,30).*B(:,35).*ky + B(:,48).*B(:,53).*kz;
    BKB(:,216) = B(:,12).*B(:,18).*kx + B(:,30).*B(:,36).*ky + B(:,48).*B(:,54).*kz;
    BKB(:,217) = B(:,1).*B(:,13).*kx + B(:,19).*B(:,31).*ky + B(:,37).*B(:,49).*kz;
    BKB(:,218) = B(:,2).*B(:,13).*kx + B(:,20).*B(:,31).*ky + B(:,38).*B(:,49).*kz;
    BKB(:,219) = B(:,3).*B(:,13).*kx + B(:,21).*B(:,31).*ky + B(:,39).*B(:,49).*kz;
    BKB(:,220) = B(:,4).*B(:,13).*kx + B(:,22).*B(:,31).*ky + B(:,40).*B(:,49).*kz;
    BKB(:,221) = B(:,5).*B(:,13).*kx + B(:,23).*B(:,31).*ky + B(:,41).*B(:,49).*kz;
    BKB(:,222) = B(:,6).*B(:,13).*kx + B(:,24).*B(:,31).*ky + B(:,42).*B(:,49).*kz;
    BKB(:,223) = B(:,7).*B(:,13).*kx + B(:,25).*B(:,31).*ky + B(:,43).*B(:,49).*kz;
    BKB(:,224) = B(:,8).*B(:,13).*kx + B(:,26).*B(:,31).*ky + B(:,44).*B(:,49).*kz;
    BKB(:,225) = B(:,9).*B(:,13).*kx + B(:,27).*B(:,31).*ky + B(:,45).*B(:,49).*kz;
    BKB(:,226) = B(:,10).*B(:,13).*kx + B(:,28).*B(:,31).*ky + B(:,46).*B(:,49).*kz;
    BKB(:,227) = B(:,11).*B(:,13).*kx + B(:,29).*B(:,31).*ky + B(:,47).*B(:,49).*kz;
    BKB(:,228) = B(:,12).*B(:,13).*kx + B(:,30).*B(:,31).*ky + B(:,48).*B(:,49).*kz;
    BKB(:,229) = kx.*B(:,13).^2 + ky.*B(:,31).^2 + kz.*B(:,49).^2;
    BKB(:,230) = B(:,13).*B(:,14).*kx + B(:,31).*B(:,32).*ky + B(:,49).*B(:,50).*kz;
    BKB(:,231) = B(:,13).*B(:,15).*kx + B(:,31).*B(:,33).*ky + B(:,49).*B(:,51).*kz;
    BKB(:,232) = B(:,13).*B(:,16).*kx + B(:,31).*B(:,34).*ky + B(:,49).*B(:,52).*kz;
    BKB(:,233) = B(:,13).*B(:,17).*kx + B(:,31).*B(:,35).*ky + B(:,49).*B(:,53).*kz;
    BKB(:,234) = B(:,13).*B(:,18).*kx + B(:,31).*B(:,36).*ky + B(:,49).*B(:,54).*kz;
    BKB(:,235) = B(:,1).*B(:,14).*kx + B(:,19).*B(:,32).*ky + B(:,37).*B(:,50).*kz;
    BKB(:,236) = B(:,2).*B(:,14).*kx + B(:,20).*B(:,32).*ky + B(:,38).*B(:,50).*kz;
    BKB(:,237) = B(:,3).*B(:,14).*kx + B(:,21).*B(:,32).*ky + B(:,39).*B(:,50).*kz;
    BKB(:,238) = B(:,4).*B(:,14).*kx + B(:,22).*B(:,32).*ky + B(:,40).*B(:,50).*kz;
    BKB(:,239) = B(:,5).*B(:,14).*kx + B(:,23).*B(:,32).*ky + B(:,41).*B(:,50).*kz;
    BKB(:,240) = B(:,6).*B(:,14).*kx + B(:,24).*B(:,32).*ky + B(:,42).*B(:,50).*kz;
    BKB(:,241) = B(:,7).*B(:,14).*kx + B(:,25).*B(:,32).*ky + B(:,43).*B(:,50).*kz;
    BKB(:,242) = B(:,8).*B(:,14).*kx + B(:,26).*B(:,32).*ky + B(:,44).*B(:,50).*kz;
    BKB(:,243) = B(:,9).*B(:,14).*kx + B(:,27).*B(:,32).*ky + B(:,45).*B(:,50).*kz;
    BKB(:,244) = B(:,10).*B(:,14).*kx + B(:,28).*B(:,32).*ky + B(:,46).*B(:,50).*kz;
    BKB(:,245) = B(:,11).*B(:,14).*kx + B(:,29).*B(:,32).*ky + B(:,47).*B(:,50).*kz;
    BKB(:,246) = B(:,12).*B(:,14).*kx + B(:,30).*B(:,32).*ky + B(:,48).*B(:,50).*kz;
    BKB(:,247) = B(:,13).*B(:,14).*kx + B(:,31).*B(:,32).*ky + B(:,49).*B(:,50).*kz;
    BKB(:,248) = kx.*B(:,14).^2 + ky.*B(:,32).^2 + kz.*B(:,50).^2;
    BKB(:,249) = B(:,14).*B(:,15).*kx + B(:,32).*B(:,33).*ky + B(:,50).*B(:,51).*kz;
    BKB(:,250) = B(:,14).*B(:,16).*kx + B(:,32).*B(:,34).*ky + B(:,50).*B(:,52).*kz;
    BKB(:,251) = B(:,14).*B(:,17).*kx + B(:,32).*B(:,35).*ky + B(:,50).*B(:,53).*kz;
    BKB(:,252) = B(:,14).*B(:,18).*kx + B(:,32).*B(:,36).*ky + B(:,50).*B(:,54).*kz;
    BKB(:,253) = B(:,1).*B(:,15).*kx + B(:,19).*B(:,33).*ky + B(:,37).*B(:,51).*kz;
    BKB(:,254) = B(:,2).*B(:,15).*kx + B(:,20).*B(:,33).*ky + B(:,38).*B(:,51).*kz;
    BKB(:,255) = B(:,3).*B(:,15).*kx + B(:,21).*B(:,33).*ky + B(:,39).*B(:,51).*kz;
    BKB(:,256) = B(:,4).*B(:,15).*kx + B(:,22).*B(:,33).*ky + B(:,40).*B(:,51).*kz;
    BKB(:,257) = B(:,5).*B(:,15).*kx + B(:,23).*B(:,33).*ky + B(:,41).*B(:,51).*kz;
    BKB(:,258) = B(:,6).*B(:,15).*kx + B(:,24).*B(:,33).*ky + B(:,42).*B(:,51).*kz;
    BKB(:,259) = B(:,7).*B(:,15).*kx + B(:,25).*B(:,33).*ky + B(:,43).*B(:,51).*kz;
    BKB(:,260) = B(:,8).*B(:,15).*kx + B(:,26).*B(:,33).*ky + B(:,44).*B(:,51).*kz;
    BKB(:,261) = B(:,9).*B(:,15).*kx + B(:,27).*B(:,33).*ky + B(:,45).*B(:,51).*kz;
    BKB(:,262) = B(:,10).*B(:,15).*kx + B(:,28).*B(:,33).*ky + B(:,46).*B(:,51).*kz;
    BKB(:,263) = B(:,11).*B(:,15).*kx + B(:,29).*B(:,33).*ky + B(:,47).*B(:,51).*kz;
    BKB(:,264) = B(:,12).*B(:,15).*kx + B(:,30).*B(:,33).*ky + B(:,48).*B(:,51).*kz;
    BKB(:,265) = B(:,13).*B(:,15).*kx + B(:,31).*B(:,33).*ky + B(:,49).*B(:,51).*kz;
    BKB(:,266) = B(:,14).*B(:,15).*kx + B(:,32).*B(:,33).*ky + B(:,50).*B(:,51).*kz;
    BKB(:,267) = kx.*B(:,15).^2 + ky.*B(:,33).^2 + kz.*B(:,51).^2;
    BKB(:,268) = B(:,15).*B(:,16).*kx + B(:,33).*B(:,34).*ky + B(:,51).*B(:,52).*kz;
    BKB(:,269) = B(:,15).*B(:,17).*kx + B(:,33).*B(:,35).*ky + B(:,51).*B(:,53).*kz;
    BKB(:,270) = B(:,15).*B(:,18).*kx + B(:,33).*B(:,36).*ky + B(:,51).*B(:,54).*kz;
    BKB(:,271) = B(:,1).*B(:,16).*kx + B(:,19).*B(:,34).*ky + B(:,37).*B(:,52).*kz;
    BKB(:,272) = B(:,2).*B(:,16).*kx + B(:,20).*B(:,34).*ky + B(:,38).*B(:,52).*kz;
    BKB(:,273) = B(:,3).*B(:,16).*kx + B(:,21).*B(:,34).*ky + B(:,39).*B(:,52).*kz;
    BKB(:,274) = B(:,4).*B(:,16).*kx + B(:,22).*B(:,34).*ky + B(:,40).*B(:,52).*kz;
    BKB(:,275) = B(:,5).*B(:,16).*kx + B(:,23).*B(:,34).*ky + B(:,41).*B(:,52).*kz;
    BKB(:,276) = B(:,6).*B(:,16).*kx + B(:,24).*B(:,34).*ky + B(:,42).*B(:,52).*kz;
    BKB(:,277) = B(:,7).*B(:,16).*kx + B(:,25).*B(:,34).*ky + B(:,43).*B(:,52).*kz;
    BKB(:,278) = B(:,8).*B(:,16).*kx + B(:,26).*B(:,34).*ky + B(:,44).*B(:,52).*kz;
    BKB(:,279) = B(:,9).*B(:,16).*kx + B(:,27).*B(:,34).*ky + B(:,45).*B(:,52).*kz;
    BKB(:,280) = B(:,10).*B(:,16).*kx + B(:,28).*B(:,34).*ky + B(:,46).*B(:,52).*kz;
    BKB(:,281) = B(:,11).*B(:,16).*kx + B(:,29).*B(:,34).*ky + B(:,47).*B(:,52).*kz;
    BKB(:,282) = B(:,12).*B(:,16).*kx + B(:,30).*B(:,34).*ky + B(:,48).*B(:,52).*kz;
    BKB(:,283) = B(:,13).*B(:,16).*kx + B(:,31).*B(:,34).*ky + B(:,49).*B(:,52).*kz;
    BKB(:,284) = B(:,14).*B(:,16).*kx + B(:,32).*B(:,34).*ky + B(:,50).*B(:,52).*kz;
    BKB(:,285) = B(:,15).*B(:,16).*kx + B(:,33).*B(:,34).*ky + B(:,51).*B(:,52).*kz;
    BKB(:,286) = kx.*B(:,16).^2 + ky.*B(:,34).^2 + kz.*B(:,52).^2;
    BKB(:,287) = B(:,16).*B(:,17).*kx + B(:,34).*B(:,35).*ky + B(:,52).*B(:,53).*kz;
    BKB(:,288) = B(:,16).*B(:,18).*kx + B(:,34).*B(:,36).*ky + B(:,52).*B(:,54).*kz;
    BKB(:,289) = B(:,1).*B(:,17).*kx + B(:,19).*B(:,35).*ky + B(:,37).*B(:,53).*kz;
    BKB(:,290) = B(:,2).*B(:,17).*kx + B(:,20).*B(:,35).*ky + B(:,38).*B(:,53).*kz;
    BKB(:,291) = B(:,3).*B(:,17).*kx + B(:,21).*B(:,35).*ky + B(:,39).*B(:,53).*kz;
    BKB(:,292) = B(:,4).*B(:,17).*kx + B(:,22).*B(:,35).*ky + B(:,40).*B(:,53).*kz;
    BKB(:,293) = B(:,5).*B(:,17).*kx + B(:,23).*B(:,35).*ky + B(:,41).*B(:,53).*kz;
    BKB(:,294) = B(:,6).*B(:,17).*kx + B(:,24).*B(:,35).*ky + B(:,42).*B(:,53).*kz;
    BKB(:,295) = B(:,7).*B(:,17).*kx + B(:,25).*B(:,35).*ky + B(:,43).*B(:,53).*kz;
    BKB(:,296) = B(:,8).*B(:,17).*kx + B(:,26).*B(:,35).*ky + B(:,44).*B(:,53).*kz;
    BKB(:,297) = B(:,9).*B(:,17).*kx + B(:,27).*B(:,35).*ky + B(:,45).*B(:,53).*kz;
    BKB(:,298) = B(:,10).*B(:,17).*kx + B(:,28).*B(:,35).*ky + B(:,46).*B(:,53).*kz;
    BKB(:,299) = B(:,11).*B(:,17).*kx + B(:,29).*B(:,35).*ky + B(:,47).*B(:,53).*kz;
    BKB(:,300) = B(:,12).*B(:,17).*kx + B(:,30).*B(:,35).*ky + B(:,48).*B(:,53).*kz;
    BKB(:,301) = B(:,13).*B(:,17).*kx + B(:,31).*B(:,35).*ky + B(:,49).*B(:,53).*kz;
    BKB(:,302) = B(:,14).*B(:,17).*kx + B(:,32).*B(:,35).*ky + B(:,50).*B(:,53).*kz;
    BKB(:,303) = B(:,15).*B(:,17).*kx + B(:,33).*B(:,35).*ky + B(:,51).*B(:,53).*kz;
    BKB(:,304) = B(:,16).*B(:,17).*kx + B(:,34).*B(:,35).*ky + B(:,52).*B(:,53).*kz;
    BKB(:,305) = kx.*B(:,17).^2 + ky.*B(:,35).^2 + kz.*B(:,53).^2;
    BKB(:,306) = B(:,17).*B(:,18).*kx + B(:,35).*B(:,36).*ky + B(:,53).*B(:,54).*kz;
    BKB(:,307) = B(:,1).*B(:,18).*kx + B(:,19).*B(:,36).*ky + B(:,37).*B(:,54).*kz;
    BKB(:,308) = B(:,2).*B(:,18).*kx + B(:,20).*B(:,36).*ky + B(:,38).*B(:,54).*kz;
    BKB(:,309) = B(:,3).*B(:,18).*kx + B(:,21).*B(:,36).*ky + B(:,39).*B(:,54).*kz;
    BKB(:,310) = B(:,4).*B(:,18).*kx + B(:,22).*B(:,36).*ky + B(:,40).*B(:,54).*kz;
    BKB(:,311) = B(:,5).*B(:,18).*kx + B(:,23).*B(:,36).*ky + B(:,41).*B(:,54).*kz;
    BKB(:,312) = B(:,6).*B(:,18).*kx + B(:,24).*B(:,36).*ky + B(:,42).*B(:,54).*kz;
    BKB(:,313) = B(:,7).*B(:,18).*kx + B(:,25).*B(:,36).*ky + B(:,43).*B(:,54).*kz;
    BKB(:,314) = B(:,8).*B(:,18).*kx + B(:,26).*B(:,36).*ky + B(:,44).*B(:,54).*kz;
    BKB(:,315) = B(:,9).*B(:,18).*kx + B(:,27).*B(:,36).*ky + B(:,45).*B(:,54).*kz;
    BKB(:,316) = B(:,10).*B(:,18).*kx + B(:,28).*B(:,36).*ky + B(:,46).*B(:,54).*kz;
    BKB(:,317) = B(:,11).*B(:,18).*kx + B(:,29).*B(:,36).*ky + B(:,47).*B(:,54).*kz;
    BKB(:,318) = B(:,12).*B(:,18).*kx + B(:,30).*B(:,36).*ky + B(:,48).*B(:,54).*kz;
    BKB(:,319) = B(:,13).*B(:,18).*kx + B(:,31).*B(:,36).*ky + B(:,49).*B(:,54).*kz;
    BKB(:,320) = B(:,14).*B(:,18).*kx + B(:,32).*B(:,36).*ky + B(:,50).*B(:,54).*kz;
    BKB(:,321) = B(:,15).*B(:,18).*kx + B(:,33).*B(:,36).*ky + B(:,51).*B(:,54).*kz;
    BKB(:,322) = B(:,16).*B(:,18).*kx + B(:,34).*B(:,36).*ky + B(:,52).*B(:,54).*kz;
    BKB(:,323) = B(:,17).*B(:,18).*kx + B(:,35).*B(:,36).*ky + B(:,53).*B(:,54).*kz;
    BKB(:,324) = kx.*B(:,18).^2 + ky.*B(:,36).^2 + kz.*B(:,54).^2;
else
    if ii==1;  BKB= kx.*B(:,1).^2 + ky.*B(:,19).^2 + kz.*B(:,37).^2;                             return;  end
    if ii==2;  BKB= B(:,1).*B(:,2).*kx + B(:,19).*B(:,20).*ky + B(:,37).*B(:,38).*kz;            return;  end
    if ii==3;  BKB= B(:,1).*B(:,3).*kx + B(:,19).*B(:,21).*ky + B(:,37).*B(:,39).*kz;            return;  end
    if ii==4;  BKB= B(:,1).*B(:,4).*kx + B(:,19).*B(:,22).*ky + B(:,37).*B(:,40).*kz;            return;  end
    if ii==5;  BKB= B(:,1).*B(:,5).*kx + B(:,19).*B(:,23).*ky + B(:,37).*B(:,41).*kz;            return;  end
    if ii==6;  BKB= B(:,1).*B(:,6).*kx + B(:,19).*B(:,24).*ky + B(:,37).*B(:,42).*kz;            return;  end
    if ii==7;  BKB= B(:,1).*B(:,7).*kx + B(:,19).*B(:,25).*ky + B(:,37).*B(:,43).*kz;            return;  end
    if ii==8;  BKB= B(:,1).*B(:,8).*kx + B(:,19).*B(:,26).*ky + B(:,37).*B(:,44).*kz;            return;  end
    if ii==9;  BKB= B(:,1).*B(:,9).*kx + B(:,19).*B(:,27).*ky + B(:,37).*B(:,45).*kz;            return;  end
    if ii==10; BKB = B(:,1).*B(:,10).*kx + B(:,19).*B(:,28).*ky + B(:,37).*B(:,46).*kz;          return;  end
    if ii==11; BKB = B(:,1).*B(:,11).*kx + B(:,19).*B(:,29).*ky + B(:,37).*B(:,47).*kz;          return;  end
    if ii==12; BKB = B(:,1).*B(:,12).*kx + B(:,19).*B(:,30).*ky + B(:,37).*B(:,48).*kz;          return;  end
    if ii==13; BKB = B(:,1).*B(:,13).*kx + B(:,19).*B(:,31).*ky + B(:,37).*B(:,49).*kz;          return;  end
    if ii==14; BKB = B(:,1).*B(:,14).*kx + B(:,19).*B(:,32).*ky + B(:,37).*B(:,50).*kz;          return;  end
    if ii==15; BKB = B(:,1).*B(:,15).*kx + B(:,19).*B(:,33).*ky + B(:,37).*B(:,51).*kz;          return;  end
    if ii==16; BKB = B(:,1).*B(:,16).*kx + B(:,19).*B(:,34).*ky + B(:,37).*B(:,52).*kz;          return;  end
    if ii==17; BKB = B(:,1).*B(:,17).*kx + B(:,19).*B(:,35).*ky + B(:,37).*B(:,53).*kz;          return;  end
    if ii==18; BKB = B(:,1).*B(:,18).*kx + B(:,19).*B(:,36).*ky + B(:,37).*B(:,54).*kz;          return;  end
    if ii==19; BKB = B(:,1).*B(:,2).*kx + B(:,19).*B(:,20).*ky + B(:,37).*B(:,38).*kz;           return;  end
    if ii==20; BKB = kx.*B(:,2).^2 + ky.*B(:,20).^2 + kz.*B(:,38).^2;                            return;  end
    if ii==21; BKB = B(:,2).*B(:,3).*kx + B(:,20).*B(:,21).*ky + B(:,38).*B(:,39).*kz;           return;  end
    if ii==22; BKB = B(:,2).*B(:,4).*kx + B(:,20).*B(:,22).*ky + B(:,38).*B(:,40).*kz;           return;  end
    if ii==23; BKB = B(:,2).*B(:,5).*kx + B(:,20).*B(:,23).*ky + B(:,38).*B(:,41).*kz;           return;  end
    if ii==24; BKB = B(:,2).*B(:,6).*kx + B(:,20).*B(:,24).*ky + B(:,38).*B(:,42).*kz;           return;  end
    if ii==25; BKB = B(:,2).*B(:,7).*kx + B(:,20).*B(:,25).*ky + B(:,38).*B(:,43).*kz;           return;  end
    if ii==26; BKB = B(:,2).*B(:,8).*kx + B(:,20).*B(:,26).*ky + B(:,38).*B(:,44).*kz;           return;  end
    if ii==27; BKB = B(:,2).*B(:,9).*kx + B(:,20).*B(:,27).*ky + B(:,38).*B(:,45).*kz;           return;  end
    if ii==28; BKB = B(:,2).*B(:,10).*kx + B(:,20).*B(:,28).*ky + B(:,38).*B(:,46).*kz;          return;  end
    if ii==29; BKB = B(:,2).*B(:,11).*kx + B(:,20).*B(:,29).*ky + B(:,38).*B(:,47).*kz;          return;  end
    if ii==30; BKB = B(:,2).*B(:,12).*kx + B(:,20).*B(:,30).*ky + B(:,38).*B(:,48).*kz;          return;  end
    if ii==31; BKB = B(:,2).*B(:,13).*kx + B(:,20).*B(:,31).*ky + B(:,38).*B(:,49).*kz;          return;  end
    if ii==32; BKB = B(:,2).*B(:,14).*kx + B(:,20).*B(:,32).*ky + B(:,38).*B(:,50).*kz;          return;  end
    if ii==33; BKB = B(:,2).*B(:,15).*kx + B(:,20).*B(:,33).*ky + B(:,38).*B(:,51).*kz;          return;  end
    if ii==34; BKB = B(:,2).*B(:,16).*kx + B(:,20).*B(:,34).*ky + B(:,38).*B(:,52).*kz;          return;  end
    if ii==35; BKB = B(:,2).*B(:,17).*kx + B(:,20).*B(:,35).*ky + B(:,38).*B(:,53).*kz;          return;  end
    if ii==36; BKB = B(:,2).*B(:,18).*kx + B(:,20).*B(:,36).*ky + B(:,38).*B(:,54).*kz;          return;  end
    if ii==37; BKB = B(:,1).*B(:,3).*kx + B(:,19).*B(:,21).*ky + B(:,37).*B(:,39).*kz;           return;  end
    if ii==38; BKB = B(:,2).*B(:,3).*kx + B(:,20).*B(:,21).*ky + B(:,38).*B(:,39).*kz;           return;  end
    if ii==39; BKB = kx.*B(:,3).^2 + ky.*B(:,21).^2 + kz.*B(:,39).^2;                            return;  end
    if ii==40; BKB = B(:,3).*B(:,4).*kx + B(:,21).*B(:,22).*ky + B(:,39).*B(:,40).*kz;           return;  end
    if ii==41; BKB = B(:,3).*B(:,5).*kx + B(:,21).*B(:,23).*ky + B(:,39).*B(:,41).*kz;           return;  end
    if ii==42; BKB = B(:,3).*B(:,6).*kx + B(:,21).*B(:,24).*ky + B(:,39).*B(:,42).*kz;           return;  end
    if ii==43; BKB = B(:,3).*B(:,7).*kx + B(:,21).*B(:,25).*ky + B(:,39).*B(:,43).*kz;           return;  end
    if ii==44; BKB = B(:,3).*B(:,8).*kx + B(:,21).*B(:,26).*ky + B(:,39).*B(:,44).*kz;           return;  end
    if ii==45; BKB = B(:,3).*B(:,9).*kx + B(:,21).*B(:,27).*ky + B(:,39).*B(:,45).*kz;           return;  end
    if ii==46; BKB = B(:,3).*B(:,10).*kx + B(:,21).*B(:,28).*ky + B(:,39).*B(:,46).*kz;          return;  end
    if ii==47; BKB = B(:,3).*B(:,11).*kx + B(:,21).*B(:,29).*ky + B(:,39).*B(:,47).*kz;          return;  end
    if ii==48; BKB = B(:,3).*B(:,12).*kx + B(:,21).*B(:,30).*ky + B(:,39).*B(:,48).*kz;          return;  end
    if ii==49; BKB = B(:,3).*B(:,13).*kx + B(:,21).*B(:,31).*ky + B(:,39).*B(:,49).*kz;          return;  end
    if ii==50; BKB = B(:,3).*B(:,14).*kx + B(:,21).*B(:,32).*ky + B(:,39).*B(:,50).*kz;          return;  end
    if ii==51; BKB = B(:,3).*B(:,15).*kx + B(:,21).*B(:,33).*ky + B(:,39).*B(:,51).*kz;          return;  end
    if ii==52; BKB = B(:,3).*B(:,16).*kx + B(:,21).*B(:,34).*ky + B(:,39).*B(:,52).*kz;          return;  end
    if ii==53; BKB = B(:,3).*B(:,17).*kx + B(:,21).*B(:,35).*ky + B(:,39).*B(:,53).*kz;          return;  end
    if ii==54; BKB = B(:,3).*B(:,18).*kx + B(:,21).*B(:,36).*ky + B(:,39).*B(:,54).*kz;          return;  end
    if ii==55; BKB = B(:,1).*B(:,4).*kx + B(:,19).*B(:,22).*ky + B(:,37).*B(:,40).*kz;           return;  end
    if ii==56; BKB = B(:,2).*B(:,4).*kx + B(:,20).*B(:,22).*ky + B(:,38).*B(:,40).*kz;           return;  end
    if ii==57; BKB = B(:,3).*B(:,4).*kx + B(:,21).*B(:,22).*ky + B(:,39).*B(:,40).*kz;           return;  end
    if ii==58; BKB = kx.*B(:,4).^2 + ky.*B(:,22).^2 + kz.*B(:,40).^2;                            return;  end
    if ii==59; BKB = B(:,4).*B(:,5).*kx + B(:,22).*B(:,23).*ky + B(:,40).*B(:,41).*kz;           return;  end
    if ii==60; BKB = B(:,4).*B(:,6).*kx + B(:,22).*B(:,24).*ky + B(:,40).*B(:,42).*kz;           return;  end
    if ii==61; BKB = B(:,4).*B(:,7).*kx + B(:,22).*B(:,25).*ky + B(:,40).*B(:,43).*kz;           return;  end
    if ii==62; BKB = B(:,4).*B(:,8).*kx + B(:,22).*B(:,26).*ky + B(:,40).*B(:,44).*kz;           return;  end
    if ii==63; BKB = B(:,4).*B(:,9).*kx + B(:,22).*B(:,27).*ky + B(:,40).*B(:,45).*kz;           return;  end
    if ii==64; BKB = B(:,4).*B(:,10).*kx + B(:,22).*B(:,28).*ky + B(:,40).*B(:,46).*kz;          return;  end
    if ii==65; BKB = B(:,4).*B(:,11).*kx + B(:,22).*B(:,29).*ky + B(:,40).*B(:,47).*kz;          return;  end
    if ii==66; BKB = B(:,4).*B(:,12).*kx + B(:,22).*B(:,30).*ky + B(:,40).*B(:,48).*kz;          return;  end
    if ii==67; BKB = B(:,4).*B(:,13).*kx + B(:,22).*B(:,31).*ky + B(:,40).*B(:,49).*kz;          return;  end
    if ii==68; BKB = B(:,4).*B(:,14).*kx + B(:,22).*B(:,32).*ky + B(:,40).*B(:,50).*kz;          return;  end
    if ii==69; BKB = B(:,4).*B(:,15).*kx + B(:,22).*B(:,33).*ky + B(:,40).*B(:,51).*kz;          return;  end
    if ii==70; BKB = B(:,4).*B(:,16).*kx + B(:,22).*B(:,34).*ky + B(:,40).*B(:,52).*kz;          return;  end
    if ii==71; BKB = B(:,4).*B(:,17).*kx + B(:,22).*B(:,35).*ky + B(:,40).*B(:,53).*kz;          return;  end
    if ii==72; BKB = B(:,4).*B(:,18).*kx + B(:,22).*B(:,36).*ky + B(:,40).*B(:,54).*kz;          return;  end
    if ii==73; BKB = B(:,1).*B(:,5).*kx + B(:,19).*B(:,23).*ky + B(:,37).*B(:,41).*kz;           return;  end
    if ii==74; BKB = B(:,2).*B(:,5).*kx + B(:,20).*B(:,23).*ky + B(:,38).*B(:,41).*kz;           return;  end
    if ii==75; BKB = B(:,3).*B(:,5).*kx + B(:,21).*B(:,23).*ky + B(:,39).*B(:,41).*kz;           return;  end
    if ii==76; BKB = B(:,4).*B(:,5).*kx + B(:,22).*B(:,23).*ky + B(:,40).*B(:,41).*kz;           return;  end
    if ii==77; BKB = kx.*B(:,5).^2 + ky.*B(:,23).^2 + kz.*B(:,41).^2;                            return;  end
    if ii==78; BKB = B(:,5).*B(:,6).*kx + B(:,23).*B(:,24).*ky + B(:,41).*B(:,42).*kz;           return;  end
    if ii==79; BKB = B(:,5).*B(:,7).*kx + B(:,23).*B(:,25).*ky + B(:,41).*B(:,43).*kz;           return;  end
    if ii==80; BKB = B(:,5).*B(:,8).*kx + B(:,23).*B(:,26).*ky + B(:,41).*B(:,44).*kz;           return;  end
    if ii==81; BKB = B(:,5).*B(:,9).*kx + B(:,23).*B(:,27).*ky + B(:,41).*B(:,45).*kz;           return;  end
    if ii==82; BKB = B(:,5).*B(:,10).*kx + B(:,23).*B(:,28).*ky + B(:,41).*B(:,46).*kz;          return;  end
    if ii==83; BKB = B(:,5).*B(:,11).*kx + B(:,23).*B(:,29).*ky + B(:,41).*B(:,47).*kz;          return;  end
    if ii==84; BKB = B(:,5).*B(:,12).*kx + B(:,23).*B(:,30).*ky + B(:,41).*B(:,48).*kz;          return;  end
    if ii==85; BKB = B(:,5).*B(:,13).*kx + B(:,23).*B(:,31).*ky + B(:,41).*B(:,49).*kz;          return;  end
    if ii==86; BKB = B(:,5).*B(:,14).*kx + B(:,23).*B(:,32).*ky + B(:,41).*B(:,50).*kz;          return;  end
    if ii==87; BKB = B(:,5).*B(:,15).*kx + B(:,23).*B(:,33).*ky + B(:,41).*B(:,51).*kz;          return;  end
    if ii==88; BKB = B(:,5).*B(:,16).*kx + B(:,23).*B(:,34).*ky + B(:,41).*B(:,52).*kz;          return;  end
    if ii==89; BKB = B(:,5).*B(:,17).*kx + B(:,23).*B(:,35).*ky + B(:,41).*B(:,53).*kz;          return;  end
    if ii==90; BKB = B(:,5).*B(:,18).*kx + B(:,23).*B(:,36).*ky + B(:,41).*B(:,54).*kz;          return;  end
    if ii==91; BKB = B(:,1).*B(:,6).*kx + B(:,19).*B(:,24).*ky + B(:,37).*B(:,42).*kz;           return;  end
    if ii==92; BKB = B(:,2).*B(:,6).*kx + B(:,20).*B(:,24).*ky + B(:,38).*B(:,42).*kz;           return;  end
    if ii==93; BKB = B(:,3).*B(:,6).*kx + B(:,21).*B(:,24).*ky + B(:,39).*B(:,42).*kz;           return;  end
    if ii==94; BKB = B(:,4).*B(:,6).*kx + B(:,22).*B(:,24).*ky + B(:,40).*B(:,42).*kz;           return;  end
    if ii==95; BKB = B(:,5).*B(:,6).*kx + B(:,23).*B(:,24).*ky + B(:,41).*B(:,42).*kz;           return;  end
    if ii==96; BKB = kx.*B(:,6).^2 + ky.*B(:,24).^2 + kz.*B(:,42).^2;                            return;  end
    if ii==97; BKB = B(:,6).*B(:,7).*kx + B(:,24).*B(:,25).*ky + B(:,42).*B(:,43).*kz;           return;  end
    if ii==98; BKB = B(:,6).*B(:,8).*kx + B(:,24).*B(:,26).*ky + B(:,42).*B(:,44).*kz;           return;  end
    if ii==99; BKB = B(:,6).*B(:,9).*kx + B(:,24).*B(:,27).*ky + B(:,42).*B(:,45).*kz;           return;  end
    if ii==100; BKB = B(:,6).*B(:,10).*kx + B(:,24).*B(:,28).*ky + B(:,42).*B(:,46).*kz;         return; end
    if ii==101; BKB = B(:,6).*B(:,11).*kx + B(:,24).*B(:,29).*ky + B(:,42).*B(:,47).*kz;         return; end
    if ii==102; BKB = B(:,6).*B(:,12).*kx + B(:,24).*B(:,30).*ky + B(:,42).*B(:,48).*kz;         return; end
    if ii==103; BKB = B(:,6).*B(:,13).*kx + B(:,24).*B(:,31).*ky + B(:,42).*B(:,49).*kz;         return; end
    if ii==104; BKB = B(:,6).*B(:,14).*kx + B(:,24).*B(:,32).*ky + B(:,42).*B(:,50).*kz;         return; end
    if ii==105; BKB = B(:,6).*B(:,15).*kx + B(:,24).*B(:,33).*ky + B(:,42).*B(:,51).*kz;         return; end
    if ii==106; BKB = B(:,6).*B(:,16).*kx + B(:,24).*B(:,34).*ky + B(:,42).*B(:,52).*kz;         return; end
    if ii==107; BKB = B(:,6).*B(:,17).*kx + B(:,24).*B(:,35).*ky + B(:,42).*B(:,53).*kz;         return; end
    if ii==108; BKB = B(:,6).*B(:,18).*kx + B(:,24).*B(:,36).*ky + B(:,42).*B(:,54).*kz;         return; end
    if ii==109; BKB = B(:,1).*B(:,7).*kx + B(:,19).*B(:,25).*ky + B(:,37).*B(:,43).*kz;          return; end
    if ii==110; BKB = B(:,2).*B(:,7).*kx + B(:,20).*B(:,25).*ky + B(:,38).*B(:,43).*kz;          return; end
    if ii==111; BKB = B(:,3).*B(:,7).*kx + B(:,21).*B(:,25).*ky + B(:,39).*B(:,43).*kz;          return; end
    if ii==112; BKB = B(:,4).*B(:,7).*kx + B(:,22).*B(:,25).*ky + B(:,40).*B(:,43).*kz;          return; end
    if ii==113; BKB = B(:,5).*B(:,7).*kx + B(:,23).*B(:,25).*ky + B(:,41).*B(:,43).*kz;          return; end
    if ii==114; BKB = B(:,6).*B(:,7).*kx + B(:,24).*B(:,25).*ky + B(:,42).*B(:,43).*kz;          return; end
    if ii==115; BKB = kx.*B(:,7).^2 + ky.*B(:,25).^2 + kz.*B(:,43).^2;                           return; end
    if ii==116; BKB = B(:,7).*B(:,8).*kx + B(:,25).*B(:,26).*ky + B(:,43).*B(:,44).*kz;          return; end
    if ii==117; BKB = B(:,7).*B(:,9).*kx + B(:,25).*B(:,27).*ky + B(:,43).*B(:,45).*kz;          return; end
    if ii==118; BKB = B(:,7).*B(:,10).*kx + B(:,25).*B(:,28).*ky + B(:,43).*B(:,46).*kz;         return; end
    if ii==119; BKB = B(:,7).*B(:,11).*kx + B(:,25).*B(:,29).*ky + B(:,43).*B(:,47).*kz;         return; end
    if ii==120; BKB = B(:,7).*B(:,12).*kx + B(:,25).*B(:,30).*ky + B(:,43).*B(:,48).*kz;         return; end
    if ii==121; BKB = B(:,7).*B(:,13).*kx + B(:,25).*B(:,31).*ky + B(:,43).*B(:,49).*kz;         return; end
    if ii==122; BKB = B(:,7).*B(:,14).*kx + B(:,25).*B(:,32).*ky + B(:,43).*B(:,50).*kz;         return; end
    if ii==123; BKB = B(:,7).*B(:,15).*kx + B(:,25).*B(:,33).*ky + B(:,43).*B(:,51).*kz;         return; end
    if ii==124; BKB = B(:,7).*B(:,16).*kx + B(:,25).*B(:,34).*ky + B(:,43).*B(:,52).*kz;         return; end
    if ii==125; BKB = B(:,7).*B(:,17).*kx + B(:,25).*B(:,35).*ky + B(:,43).*B(:,53).*kz;         return; end
    if ii==126; BKB = B(:,7).*B(:,18).*kx + B(:,25).*B(:,36).*ky + B(:,43).*B(:,54).*kz;         return; end
    if ii==127; BKB = B(:,1).*B(:,8).*kx + B(:,19).*B(:,26).*ky + B(:,37).*B(:,44).*kz;          return; end
    if ii==128; BKB = B(:,2).*B(:,8).*kx + B(:,20).*B(:,26).*ky + B(:,38).*B(:,44).*kz;          return; end
    if ii==129; BKB = B(:,3).*B(:,8).*kx + B(:,21).*B(:,26).*ky + B(:,39).*B(:,44).*kz;          return; end
    if ii==130; BKB = B(:,4).*B(:,8).*kx + B(:,22).*B(:,26).*ky + B(:,40).*B(:,44).*kz;          return; end
    if ii==131; BKB = B(:,5).*B(:,8).*kx + B(:,23).*B(:,26).*ky + B(:,41).*B(:,44).*kz;          return; end
    if ii==132; BKB = B(:,6).*B(:,8).*kx + B(:,24).*B(:,26).*ky + B(:,42).*B(:,44).*kz;          return; end
    if ii==133; BKB = B(:,7).*B(:,8).*kx + B(:,25).*B(:,26).*ky + B(:,43).*B(:,44).*kz;          return; end
    if ii==134; BKB = kx.*B(:,8).^2 + ky.*B(:,26).^2 + kz.*B(:,44).^2;                           return; end
    if ii==135; BKB = B(:,8).*B(:,9).*kx + B(:,26).*B(:,27).*ky + B(:,44).*B(:,45).*kz;          return; end
    if ii==136; BKB = B(:,8).*B(:,10).*kx + B(:,26).*B(:,28).*ky + B(:,44).*B(:,46).*kz;         return; end
    if ii==137; BKB = B(:,8).*B(:,11).*kx + B(:,26).*B(:,29).*ky + B(:,44).*B(:,47).*kz;         return; end
    if ii==138; BKB = B(:,8).*B(:,12).*kx + B(:,26).*B(:,30).*ky + B(:,44).*B(:,48).*kz;         return; end
    if ii==139; BKB = B(:,8).*B(:,13).*kx + B(:,26).*B(:,31).*ky + B(:,44).*B(:,49).*kz;         return; end
    if ii==140; BKB = B(:,8).*B(:,14).*kx + B(:,26).*B(:,32).*ky + B(:,44).*B(:,50).*kz;         return; end
    if ii==141; BKB = B(:,8).*B(:,15).*kx + B(:,26).*B(:,33).*ky + B(:,44).*B(:,51).*kz;         return; end
    if ii==142; BKB = B(:,8).*B(:,16).*kx + B(:,26).*B(:,34).*ky + B(:,44).*B(:,52).*kz;         return; end
    if ii==143; BKB = B(:,8).*B(:,17).*kx + B(:,26).*B(:,35).*ky + B(:,44).*B(:,53).*kz;         return; end
    if ii==144; BKB = B(:,8).*B(:,18).*kx + B(:,26).*B(:,36).*ky + B(:,44).*B(:,54).*kz;         return; end
    if ii==145; BKB = B(:,1).*B(:,9).*kx + B(:,19).*B(:,27).*ky + B(:,37).*B(:,45).*kz;          return; end
    if ii==146; BKB = B(:,2).*B(:,9).*kx + B(:,20).*B(:,27).*ky + B(:,38).*B(:,45).*kz;          return; end
    if ii==147; BKB = B(:,3).*B(:,9).*kx + B(:,21).*B(:,27).*ky + B(:,39).*B(:,45).*kz;          return; end
    if ii==148; BKB = B(:,4).*B(:,9).*kx + B(:,22).*B(:,27).*ky + B(:,40).*B(:,45).*kz;          return; end
    if ii==149; BKB = B(:,5).*B(:,9).*kx + B(:,23).*B(:,27).*ky + B(:,41).*B(:,45).*kz;          return; end
    if ii==150; BKB = B(:,6).*B(:,9).*kx + B(:,24).*B(:,27).*ky + B(:,42).*B(:,45).*kz;          return; end
    if ii==151; BKB = B(:,7).*B(:,9).*kx + B(:,25).*B(:,27).*ky + B(:,43).*B(:,45).*kz;          return; end
    if ii==152; BKB = B(:,8).*B(:,9).*kx + B(:,26).*B(:,27).*ky + B(:,44).*B(:,45).*kz;          return; end
    if ii==153; BKB = kx.*B(:,9).^2 + ky.*B(:,27).^2 + kz.*B(:,45).^2;                           return; end
    if ii==154; BKB = B(:,9).*B(:,10).*kx + B(:,27).*B(:,28).*ky + B(:,45).*B(:,46).*kz;         return; end
    if ii==155; BKB = B(:,9).*B(:,11).*kx + B(:,27).*B(:,29).*ky + B(:,45).*B(:,47).*kz;         return; end
    if ii==156; BKB = B(:,9).*B(:,12).*kx + B(:,27).*B(:,30).*ky + B(:,45).*B(:,48).*kz;         return; end
    if ii==157; BKB = B(:,9).*B(:,13).*kx + B(:,27).*B(:,31).*ky + B(:,45).*B(:,49).*kz;         return; end
    if ii==158; BKB = B(:,9).*B(:,14).*kx + B(:,27).*B(:,32).*ky + B(:,45).*B(:,50).*kz;         return; end
    if ii==159; BKB = B(:,9).*B(:,15).*kx + B(:,27).*B(:,33).*ky + B(:,45).*B(:,51).*kz;         return; end
    if ii==160; BKB = B(:,9).*B(:,16).*kx + B(:,27).*B(:,34).*ky + B(:,45).*B(:,52).*kz;         return; end
    if ii==161; BKB = B(:,9).*B(:,17).*kx + B(:,27).*B(:,35).*ky + B(:,45).*B(:,53).*kz;         return; end
    if ii==162; BKB = B(:,9).*B(:,18).*kx + B(:,27).*B(:,36).*ky + B(:,45).*B(:,54).*kz;         return; end
    if ii==163; BKB = B(:,1).*B(:,10).*kx + B(:,19).*B(:,28).*ky + B(:,37).*B(:,46).*kz;         return; end
    if ii==164; BKB = B(:,2).*B(:,10).*kx + B(:,20).*B(:,28).*ky + B(:,38).*B(:,46).*kz;         return; end
    if ii==165; BKB = B(:,3).*B(:,10).*kx + B(:,21).*B(:,28).*ky + B(:,39).*B(:,46).*kz;         return; end
    if ii==166; BKB = B(:,4).*B(:,10).*kx + B(:,22).*B(:,28).*ky + B(:,40).*B(:,46).*kz;         return; end
    if ii==167; BKB = B(:,5).*B(:,10).*kx + B(:,23).*B(:,28).*ky + B(:,41).*B(:,46).*kz;         return; end
    if ii==168; BKB = B(:,6).*B(:,10).*kx + B(:,24).*B(:,28).*ky + B(:,42).*B(:,46).*kz;         return; end
    if ii==169; BKB = B(:,7).*B(:,10).*kx + B(:,25).*B(:,28).*ky + B(:,43).*B(:,46).*kz;         return; end
    if ii==170; BKB = B(:,8).*B(:,10).*kx + B(:,26).*B(:,28).*ky + B(:,44).*B(:,46).*kz;         return; end
    if ii==171; BKB = B(:,9).*B(:,10).*kx + B(:,27).*B(:,28).*ky + B(:,45).*B(:,46).*kz;         return; end
    if ii==172; BKB = kx.*B(:,10).^2 + ky.*B(:,28).^2 + kz.*B(:,46).^2;                          return; end
    if ii==173; BKB = B(:,10).*B(:,11).*kx + B(:,28).*B(:,29).*ky + B(:,46).*B(:,47).*kz;        return; end
    if ii==174; BKB = B(:,10).*B(:,12).*kx + B(:,28).*B(:,30).*ky + B(:,46).*B(:,48).*kz;        return; end
    if ii==175; BKB = B(:,10).*B(:,13).*kx + B(:,28).*B(:,31).*ky + B(:,46).*B(:,49).*kz;        return; end
    if ii==176; BKB = B(:,10).*B(:,14).*kx + B(:,28).*B(:,32).*ky + B(:,46).*B(:,50).*kz;        return; end
    if ii==177; BKB = B(:,10).*B(:,15).*kx + B(:,28).*B(:,33).*ky + B(:,46).*B(:,51).*kz;        return; end
    if ii==178; BKB = B(:,10).*B(:,16).*kx + B(:,28).*B(:,34).*ky + B(:,46).*B(:,52).*kz;        return; end
    if ii==179; BKB = B(:,10).*B(:,17).*kx + B(:,28).*B(:,35).*ky + B(:,46).*B(:,53).*kz;        return; end
    if ii==180; BKB = B(:,10).*B(:,18).*kx + B(:,28).*B(:,36).*ky + B(:,46).*B(:,54).*kz;        return; end
    if ii==181; BKB = B(:,1).*B(:,11).*kx + B(:,19).*B(:,29).*ky + B(:,37).*B(:,47).*kz;         return; end
    if ii==182; BKB = B(:,2).*B(:,11).*kx + B(:,20).*B(:,29).*ky + B(:,38).*B(:,47).*kz;         return; end
    if ii==183; BKB = B(:,3).*B(:,11).*kx + B(:,21).*B(:,29).*ky + B(:,39).*B(:,47).*kz;         return; end
    if ii==184; BKB = B(:,4).*B(:,11).*kx + B(:,22).*B(:,29).*ky + B(:,40).*B(:,47).*kz;         return; end
    if ii==185; BKB = B(:,5).*B(:,11).*kx + B(:,23).*B(:,29).*ky + B(:,41).*B(:,47).*kz;         return; end
    if ii==186; BKB = B(:,6).*B(:,11).*kx + B(:,24).*B(:,29).*ky + B(:,42).*B(:,47).*kz;         return; end
    if ii==187; BKB = B(:,7).*B(:,11).*kx + B(:,25).*B(:,29).*ky + B(:,43).*B(:,47).*kz;         return; end
    if ii==188; BKB = B(:,8).*B(:,11).*kx + B(:,26).*B(:,29).*ky + B(:,44).*B(:,47).*kz;         return; end
    if ii==189; BKB = B(:,9).*B(:,11).*kx + B(:,27).*B(:,29).*ky + B(:,45).*B(:,47).*kz;         return; end
    if ii==190; BKB = B(:,10).*B(:,11).*kx + B(:,28).*B(:,29).*ky + B(:,46).*B(:,47).*kz;        return; end
    if ii==191; BKB = kx.*B(:,11).^2 + ky.*B(:,29).^2 + kz.*B(:,47).^2;                          return; end
    if ii==192; BKB = B(:,11).*B(:,12).*kx + B(:,29).*B(:,30).*ky + B(:,47).*B(:,48).*kz;        return; end
    if ii==193; BKB = B(:,11).*B(:,13).*kx + B(:,29).*B(:,31).*ky + B(:,47).*B(:,49).*kz;        return; end
    if ii==194; BKB = B(:,11).*B(:,14).*kx + B(:,29).*B(:,32).*ky + B(:,47).*B(:,50).*kz;        return; end
    if ii==195; BKB = B(:,11).*B(:,15).*kx + B(:,29).*B(:,33).*ky + B(:,47).*B(:,51).*kz;        return; end
    if ii==196; BKB = B(:,11).*B(:,16).*kx + B(:,29).*B(:,34).*ky + B(:,47).*B(:,52).*kz;        return; end
    if ii==197; BKB = B(:,11).*B(:,17).*kx + B(:,29).*B(:,35).*ky + B(:,47).*B(:,53).*kz;        return; end
    if ii==198; BKB = B(:,11).*B(:,18).*kx + B(:,29).*B(:,36).*ky + B(:,47).*B(:,54).*kz;        return; end
    if ii==199; BKB = B(:,1).*B(:,12).*kx + B(:,19).*B(:,30).*ky + B(:,37).*B(:,48).*kz;         return; end
    if ii==200; BKB = B(:,2).*B(:,12).*kx + B(:,20).*B(:,30).*ky + B(:,38).*B(:,48).*kz;         return; end
    if ii==201; BKB = B(:,3).*B(:,12).*kx + B(:,21).*B(:,30).*ky + B(:,39).*B(:,48).*kz;         return; end
    if ii==202; BKB = B(:,4).*B(:,12).*kx + B(:,22).*B(:,30).*ky + B(:,40).*B(:,48).*kz;         return; end
    if ii==203; BKB = B(:,5).*B(:,12).*kx + B(:,23).*B(:,30).*ky + B(:,41).*B(:,48).*kz;         return; end
    if ii==204; BKB = B(:,6).*B(:,12).*kx + B(:,24).*B(:,30).*ky + B(:,42).*B(:,48).*kz;         return; end
    if ii==205; BKB = B(:,7).*B(:,12).*kx + B(:,25).*B(:,30).*ky + B(:,43).*B(:,48).*kz;         return; end
    if ii==206; BKB = B(:,8).*B(:,12).*kx + B(:,26).*B(:,30).*ky + B(:,44).*B(:,48).*kz;         return; end
    if ii==207; BKB = B(:,9).*B(:,12).*kx + B(:,27).*B(:,30).*ky + B(:,45).*B(:,48).*kz;         return; end
    if ii==208; BKB = B(:,10).*B(:,12).*kx + B(:,28).*B(:,30).*ky + B(:,46).*B(:,48).*kz;        return; end
    if ii==209; BKB = B(:,11).*B(:,12).*kx + B(:,29).*B(:,30).*ky + B(:,47).*B(:,48).*kz;        return; end
    if ii==210; BKB = kx.*B(:,12).^2 + ky.*B(:,30).^2 + kz.*B(:,48).^2;                          return; end
    if ii==211; BKB = B(:,12).*B(:,13).*kx + B(:,30).*B(:,31).*ky + B(:,48).*B(:,49).*kz;        return; end
    if ii==212; BKB = B(:,12).*B(:,14).*kx + B(:,30).*B(:,32).*ky + B(:,48).*B(:,50).*kz;        return; end
    if ii==213; BKB = B(:,12).*B(:,15).*kx + B(:,30).*B(:,33).*ky + B(:,48).*B(:,51).*kz;        return; end
    if ii==214; BKB = B(:,12).*B(:,16).*kx + B(:,30).*B(:,34).*ky + B(:,48).*B(:,52).*kz;        return; end
    if ii==215; BKB = B(:,12).*B(:,17).*kx + B(:,30).*B(:,35).*ky + B(:,48).*B(:,53).*kz;        return; end
    if ii==216; BKB = B(:,12).*B(:,18).*kx + B(:,30).*B(:,36).*ky + B(:,48).*B(:,54).*kz;        return; end
    if ii==217; BKB = B(:,1).*B(:,13).*kx + B(:,19).*B(:,31).*ky + B(:,37).*B(:,49).*kz;         return; end
    if ii==218; BKB = B(:,2).*B(:,13).*kx + B(:,20).*B(:,31).*ky + B(:,38).*B(:,49).*kz;         return; end
    if ii==219; BKB = B(:,3).*B(:,13).*kx + B(:,21).*B(:,31).*ky + B(:,39).*B(:,49).*kz;         return; end
    if ii==220; BKB = B(:,4).*B(:,13).*kx + B(:,22).*B(:,31).*ky + B(:,40).*B(:,49).*kz;         return; end
    if ii==221; BKB = B(:,5).*B(:,13).*kx + B(:,23).*B(:,31).*ky + B(:,41).*B(:,49).*kz;         return; end
    if ii==222; BKB = B(:,6).*B(:,13).*kx + B(:,24).*B(:,31).*ky + B(:,42).*B(:,49).*kz;         return; end
    if ii==223; BKB = B(:,7).*B(:,13).*kx + B(:,25).*B(:,31).*ky + B(:,43).*B(:,49).*kz;         return; end
    if ii==224; BKB = B(:,8).*B(:,13).*kx + B(:,26).*B(:,31).*ky + B(:,44).*B(:,49).*kz;         return; end
    if ii==225; BKB = B(:,9).*B(:,13).*kx + B(:,27).*B(:,31).*ky + B(:,45).*B(:,49).*kz;         return; end
    if ii==226; BKB = B(:,10).*B(:,13).*kx + B(:,28).*B(:,31).*ky + B(:,46).*B(:,49).*kz;        return; end
    if ii==227; BKB = B(:,11).*B(:,13).*kx + B(:,29).*B(:,31).*ky + B(:,47).*B(:,49).*kz;        return; end
    if ii==228; BKB = B(:,12).*B(:,13).*kx + B(:,30).*B(:,31).*ky + B(:,48).*B(:,49).*kz;        return; end
    if ii==229; BKB = kx.*B(:,13).^2 + ky.*B(:,31).^2 + kz.*B(:,49).^2;                          return; end
    if ii==230; BKB = B(:,13).*B(:,14).*kx + B(:,31).*B(:,32).*ky + B(:,49).*B(:,50).*kz;        return; end
    if ii==231; BKB = B(:,13).*B(:,15).*kx + B(:,31).*B(:,33).*ky + B(:,49).*B(:,51).*kz;        return; end
    if ii==232; BKB = B(:,13).*B(:,16).*kx + B(:,31).*B(:,34).*ky + B(:,49).*B(:,52).*kz;        return; end
    if ii==233; BKB = B(:,13).*B(:,17).*kx + B(:,31).*B(:,35).*ky + B(:,49).*B(:,53).*kz;        return; end
    if ii==234; BKB = B(:,13).*B(:,18).*kx + B(:,31).*B(:,36).*ky + B(:,49).*B(:,54).*kz;        return; end
    if ii==235; BKB = B(:,1).*B(:,14).*kx + B(:,19).*B(:,32).*ky + B(:,37).*B(:,50).*kz;         return; end
    if ii==236; BKB = B(:,2).*B(:,14).*kx + B(:,20).*B(:,32).*ky + B(:,38).*B(:,50).*kz;         return; end
    if ii==237; BKB = B(:,3).*B(:,14).*kx + B(:,21).*B(:,32).*ky + B(:,39).*B(:,50).*kz;         return; end
    if ii==238; BKB = B(:,4).*B(:,14).*kx + B(:,22).*B(:,32).*ky + B(:,40).*B(:,50).*kz;         return; end
    if ii==239; BKB = B(:,5).*B(:,14).*kx + B(:,23).*B(:,32).*ky + B(:,41).*B(:,50).*kz;         return; end
    if ii==240; BKB = B(:,6).*B(:,14).*kx + B(:,24).*B(:,32).*ky + B(:,42).*B(:,50).*kz;         return; end
    if ii==241; BKB = B(:,7).*B(:,14).*kx + B(:,25).*B(:,32).*ky + B(:,43).*B(:,50).*kz;         return; end
    if ii==242; BKB = B(:,8).*B(:,14).*kx + B(:,26).*B(:,32).*ky + B(:,44).*B(:,50).*kz;         return; end
    if ii==243; BKB = B(:,9).*B(:,14).*kx + B(:,27).*B(:,32).*ky + B(:,45).*B(:,50).*kz;         return; end
    if ii==244; BKB = B(:,10).*B(:,14).*kx + B(:,28).*B(:,32).*ky + B(:,46).*B(:,50).*kz;        return; end
    if ii==245; BKB = B(:,11).*B(:,14).*kx + B(:,29).*B(:,32).*ky + B(:,47).*B(:,50).*kz;        return; end
    if ii==246; BKB = B(:,12).*B(:,14).*kx + B(:,30).*B(:,32).*ky + B(:,48).*B(:,50).*kz;        return; end
    if ii==247; BKB = B(:,13).*B(:,14).*kx + B(:,31).*B(:,32).*ky + B(:,49).*B(:,50).*kz;        return; end
    if ii==248; BKB = kx.*B(:,14).^2 + ky.*B(:,32).^2 + kz.*B(:,50).^2;                          return; end
    if ii==249; BKB = B(:,14).*B(:,15).*kx + B(:,32).*B(:,33).*ky + B(:,50).*B(:,51).*kz;        return; end
    if ii==250; BKB = B(:,14).*B(:,16).*kx + B(:,32).*B(:,34).*ky + B(:,50).*B(:,52).*kz;        return; end
    if ii==251; BKB = B(:,14).*B(:,17).*kx + B(:,32).*B(:,35).*ky + B(:,50).*B(:,53).*kz;        return; end
    if ii==252; BKB = B(:,14).*B(:,18).*kx + B(:,32).*B(:,36).*ky + B(:,50).*B(:,54).*kz;        return; end
    if ii==253; BKB = B(:,1).*B(:,15).*kx + B(:,19).*B(:,33).*ky + B(:,37).*B(:,51).*kz;         return; end
    if ii==254; BKB = B(:,2).*B(:,15).*kx + B(:,20).*B(:,33).*ky + B(:,38).*B(:,51).*kz;         return; end
    if ii==255; BKB = B(:,3).*B(:,15).*kx + B(:,21).*B(:,33).*ky + B(:,39).*B(:,51).*kz;         return; end
    if ii==256; BKB = B(:,4).*B(:,15).*kx + B(:,22).*B(:,33).*ky + B(:,40).*B(:,51).*kz;         return; end
    if ii==257; BKB = B(:,5).*B(:,15).*kx + B(:,23).*B(:,33).*ky + B(:,41).*B(:,51).*kz;         return; end
    if ii==258; BKB = B(:,6).*B(:,15).*kx + B(:,24).*B(:,33).*ky + B(:,42).*B(:,51).*kz;         return; end
    if ii==259; BKB = B(:,7).*B(:,15).*kx + B(:,25).*B(:,33).*ky + B(:,43).*B(:,51).*kz;         return; end
    if ii==260; BKB = B(:,8).*B(:,15).*kx + B(:,26).*B(:,33).*ky + B(:,44).*B(:,51).*kz;         return; end
    if ii==261; BKB = B(:,9).*B(:,15).*kx + B(:,27).*B(:,33).*ky + B(:,45).*B(:,51).*kz;         return; end
    if ii==262; BKB = B(:,10).*B(:,15).*kx + B(:,28).*B(:,33).*ky + B(:,46).*B(:,51).*kz;        return; end
    if ii==263; BKB = B(:,11).*B(:,15).*kx + B(:,29).*B(:,33).*ky + B(:,47).*B(:,51).*kz;        return; end
    if ii==264; BKB = B(:,12).*B(:,15).*kx + B(:,30).*B(:,33).*ky + B(:,48).*B(:,51).*kz;        return; end
    if ii==265; BKB = B(:,13).*B(:,15).*kx + B(:,31).*B(:,33).*ky + B(:,49).*B(:,51).*kz;        return; end
    if ii==266; BKB = B(:,14).*B(:,15).*kx + B(:,32).*B(:,33).*ky + B(:,50).*B(:,51).*kz;        return; end
    if ii==267; BKB = kx.*B(:,15).^2 + ky.*B(:,33).^2 + kz.*B(:,51).^2;                          return; end
    if ii==268; BKB = B(:,15).*B(:,16).*kx + B(:,33).*B(:,34).*ky + B(:,51).*B(:,52).*kz;        return; end
    if ii==269; BKB = B(:,15).*B(:,17).*kx + B(:,33).*B(:,35).*ky + B(:,51).*B(:,53).*kz;        return; end
    if ii==270; BKB = B(:,15).*B(:,18).*kx + B(:,33).*B(:,36).*ky + B(:,51).*B(:,54).*kz;        return; end
    if ii==271; BKB = B(:,1).*B(:,16).*kx + B(:,19).*B(:,34).*ky + B(:,37).*B(:,52).*kz;         return; end
    if ii==272; BKB = B(:,2).*B(:,16).*kx + B(:,20).*B(:,34).*ky + B(:,38).*B(:,52).*kz;         return; end
    if ii==273; BKB = B(:,3).*B(:,16).*kx + B(:,21).*B(:,34).*ky + B(:,39).*B(:,52).*kz;         return; end
    if ii==274; BKB = B(:,4).*B(:,16).*kx + B(:,22).*B(:,34).*ky + B(:,40).*B(:,52).*kz;         return; end
    if ii==275; BKB = B(:,5).*B(:,16).*kx + B(:,23).*B(:,34).*ky + B(:,41).*B(:,52).*kz;         return; end
    if ii==276; BKB = B(:,6).*B(:,16).*kx + B(:,24).*B(:,34).*ky + B(:,42).*B(:,52).*kz;         return; end
    if ii==277; BKB = B(:,7).*B(:,16).*kx + B(:,25).*B(:,34).*ky + B(:,43).*B(:,52).*kz;         return; end
    if ii==278; BKB = B(:,8).*B(:,16).*kx + B(:,26).*B(:,34).*ky + B(:,44).*B(:,52).*kz;         return; end
    if ii==279; BKB = B(:,9).*B(:,16).*kx + B(:,27).*B(:,34).*ky + B(:,45).*B(:,52).*kz;         return; end
    if ii==280; BKB = B(:,10).*B(:,16).*kx + B(:,28).*B(:,34).*ky + B(:,46).*B(:,52).*kz;        return; end
    if ii==281; BKB = B(:,11).*B(:,16).*kx + B(:,29).*B(:,34).*ky + B(:,47).*B(:,52).*kz;        return; end
    if ii==282; BKB = B(:,12).*B(:,16).*kx + B(:,30).*B(:,34).*ky + B(:,48).*B(:,52).*kz;        return; end
    if ii==283; BKB = B(:,13).*B(:,16).*kx + B(:,31).*B(:,34).*ky + B(:,49).*B(:,52).*kz;        return; end
    if ii==284; BKB = B(:,14).*B(:,16).*kx + B(:,32).*B(:,34).*ky + B(:,50).*B(:,52).*kz;        return; end
    if ii==285; BKB = B(:,15).*B(:,16).*kx + B(:,33).*B(:,34).*ky + B(:,51).*B(:,52).*kz;        return; end
    if ii==286; BKB = kx.*B(:,16).^2 + ky.*B(:,34).^2 + kz.*B(:,52).^2;                          return; end
    if ii==287; BKB = B(:,16).*B(:,17).*kx + B(:,34).*B(:,35).*ky + B(:,52).*B(:,53).*kz;        return; end
    if ii==288; BKB = B(:,16).*B(:,18).*kx + B(:,34).*B(:,36).*ky + B(:,52).*B(:,54).*kz;        return; end
    if ii==289; BKB = B(:,1).*B(:,17).*kx + B(:,19).*B(:,35).*ky + B(:,37).*B(:,53).*kz;         return; end
    if ii==290; BKB = B(:,2).*B(:,17).*kx + B(:,20).*B(:,35).*ky + B(:,38).*B(:,53).*kz;         return; end
    if ii==291; BKB = B(:,3).*B(:,17).*kx + B(:,21).*B(:,35).*ky + B(:,39).*B(:,53).*kz;         return; end
    if ii==292; BKB = B(:,4).*B(:,17).*kx + B(:,22).*B(:,35).*ky + B(:,40).*B(:,53).*kz;         return; end
    if ii==293; BKB = B(:,5).*B(:,17).*kx + B(:,23).*B(:,35).*ky + B(:,41).*B(:,53).*kz;         return; end
    if ii==294; BKB = B(:,6).*B(:,17).*kx + B(:,24).*B(:,35).*ky + B(:,42).*B(:,53).*kz;         return; end
    if ii==295; BKB = B(:,7).*B(:,17).*kx + B(:,25).*B(:,35).*ky + B(:,43).*B(:,53).*kz;         return; end
    if ii==296; BKB = B(:,8).*B(:,17).*kx + B(:,26).*B(:,35).*ky + B(:,44).*B(:,53).*kz;         return; end
    if ii==297; BKB = B(:,9).*B(:,17).*kx + B(:,27).*B(:,35).*ky + B(:,45).*B(:,53).*kz;         return; end
    if ii==298; BKB = B(:,10).*B(:,17).*kx + B(:,28).*B(:,35).*ky + B(:,46).*B(:,53).*kz;        return; end
    if ii==299; BKB = B(:,11).*B(:,17).*kx + B(:,29).*B(:,35).*ky + B(:,47).*B(:,53).*kz;        return; end
    if ii==300; BKB = B(:,12).*B(:,17).*kx + B(:,30).*B(:,35).*ky + B(:,48).*B(:,53).*kz;        return; end
    if ii==301; BKB = B(:,13).*B(:,17).*kx + B(:,31).*B(:,35).*ky + B(:,49).*B(:,53).*kz;        return; end
    if ii==302; BKB = B(:,14).*B(:,17).*kx + B(:,32).*B(:,35).*ky + B(:,50).*B(:,53).*kz;        return; end
    if ii==303; BKB = B(:,15).*B(:,17).*kx + B(:,33).*B(:,35).*ky + B(:,51).*B(:,53).*kz;        return; end
    if ii==304; BKB = B(:,16).*B(:,17).*kx + B(:,34).*B(:,35).*ky + B(:,52).*B(:,53).*kz;        return; end
    if ii==305; BKB = kx.*B(:,17).^2 + ky.*B(:,35).^2 + kz.*B(:,53).^2;                          return; end
    if ii==306; BKB = B(:,17).*B(:,18).*kx + B(:,35).*B(:,36).*ky + B(:,53).*B(:,54).*kz;        return; end
    if ii==307; BKB = B(:,1).*B(:,18).*kx + B(:,19).*B(:,36).*ky + B(:,37).*B(:,54).*kz;         return; end
    if ii==308; BKB = B(:,2).*B(:,18).*kx + B(:,20).*B(:,36).*ky + B(:,38).*B(:,54).*kz;         return; end
    if ii==309; BKB = B(:,3).*B(:,18).*kx + B(:,21).*B(:,36).*ky + B(:,39).*B(:,54).*kz;         return; end
    if ii==310; BKB = B(:,4).*B(:,18).*kx + B(:,22).*B(:,36).*ky + B(:,40).*B(:,54).*kz;         return; end
    if ii==311; BKB = B(:,5).*B(:,18).*kx + B(:,23).*B(:,36).*ky + B(:,41).*B(:,54).*kz;         return; end
    if ii==312; BKB = B(:,6).*B(:,18).*kx + B(:,24).*B(:,36).*ky + B(:,42).*B(:,54).*kz;         return; end
    if ii==313; BKB = B(:,7).*B(:,18).*kx + B(:,25).*B(:,36).*ky + B(:,43).*B(:,54).*kz;         return; end
    if ii==314; BKB = B(:,8).*B(:,18).*kx + B(:,26).*B(:,36).*ky + B(:,44).*B(:,54).*kz;         return; end
    if ii==315; BKB = B(:,9).*B(:,18).*kx + B(:,27).*B(:,36).*ky + B(:,45).*B(:,54).*kz;         return; end
    if ii==316; BKB = B(:,10).*B(:,18).*kx + B(:,28).*B(:,36).*ky + B(:,46).*B(:,54).*kz;        return; end
    if ii==317; BKB = B(:,11).*B(:,18).*kx + B(:,29).*B(:,36).*ky + B(:,47).*B(:,54).*kz;        return; end
    if ii==318; BKB = B(:,12).*B(:,18).*kx + B(:,30).*B(:,36).*ky + B(:,48).*B(:,54).*kz;        return; end
    if ii==319; BKB = B(:,13).*B(:,18).*kx + B(:,31).*B(:,36).*ky + B(:,49).*B(:,54).*kz;        return; end
    if ii==320; BKB = B(:,14).*B(:,18).*kx + B(:,32).*B(:,36).*ky + B(:,50).*B(:,54).*kz;        return; end
    if ii==321; BKB = B(:,15).*B(:,18).*kx + B(:,33).*B(:,36).*ky + B(:,51).*B(:,54).*kz;        return; end
    if ii==322; BKB = B(:,16).*B(:,18).*kx + B(:,34).*B(:,36).*ky + B(:,52).*B(:,54).*kz;        return; end
    if ii==323; BKB = B(:,17).*B(:,18).*kx + B(:,35).*B(:,36).*ky + B(:,53).*B(:,54).*kz;        return; end
    if ii==324; BKB = kx.*B(:,18).^2 + ky.*B(:,36).^2 + kz.*B(:,54).^2;                          return; end
    
end


